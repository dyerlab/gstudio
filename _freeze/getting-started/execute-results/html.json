{
  "hash": "71bf49e36ecabe532d93de52875cc3b9",
  "result": {
    "engine": "knitr",
    "markdown": "# Getting Started\n\nThis chapter covers the installation of `gstudio`, loading bundled datasets, and a quick tour of the package's core utilities.\n\n## Installation\n\nThe `gstudio` package is available from GitHub and can be installed using the `devtools` package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"devtools\")\ndevtools::install_github(\"dyerlab/gstudio\")\n```\n:::\n\n\nOnce installed, load the package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gstudio)\n```\n:::\n\n\n## Bundled Datasets\n\nThe package ships with several datasets for examples and testing:\n\n| Dataset | Description |\n|---------|-------------|\n| `arapat` | *Araptus attenuatus* multilocus microsatellite data across Baja California |\n| `aflp_arapat` | *Araptus attenuatus* AFLP marker data |\n| `cornus` | *Cornus florida* adult genotypes |\n| `cornus_florida` | *Cornus florida* mother-offspring pair data |\n| `lopho` | *Lophocereus schottii* population graph (Dyer & Nason 2004) |\n| `upiga` | *Upiga virescens* population graph |\n| `baja` | Baja California sampling location metadata |\n| `alt` | Sonoran desert altitude raster data |\n\nLoad any dataset with the `data()` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(arapat)\n```\n:::\n\n\n## Exploring a Dataset\n\nThe `arapat` dataset is a `data.frame` with both metadata columns and `locus` columns:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(arapat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Species\"    \"Cluster\"    \"Population\" \"ID\"         \"Latitude\"  \n [6] \"Longitude\"  \"LTRS\"       \"WNT\"        \"EN\"         \"EF\"        \n[11] \"ZMP\"        \"AML\"        \"ATPS\"       \"MP20\"      \n```\n\n\n:::\n\n```{.r .cell-code}\ndim(arapat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 363  14\n```\n\n\n:::\n:::\n\n\n### Identifying Locus Columns\n\nUse `column_class()` to find all columns of a particular class:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolumn_class(arapat, \"locus\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"LTRS\" \"WNT\"  \"EN\"   \"EF\"   \"ZMP\"  \"AML\"  \"ATPS\" \"MP20\"\n```\n\n\n:::\n:::\n\n\nThis returns the names of all columns that contain `locus` objects --- a function used extensively throughout the package.\n\n### Splitting by Stratum\n\nThe `partition()` function splits a data.frame by a grouping column, returning a named list:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npops <- partition(arapat, stratum = \"Species\")\nnames(pops)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Cape\"      \"Mainland\"  \"Peninsula\"\n```\n\n\n:::\n\n```{.r .cell-code}\nsapply(pops, nrow)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Cape  Mainland Peninsula \n       75        36       252 \n```\n\n\n:::\n:::\n\n\n### Ploidy\n\nCheck the ploidy level of a locus column:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nploidy(arapat$LTRS)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n [38] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[223] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[260] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[297] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[334] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n```\n\n\n:::\n:::\n\n\n## A Quick Analysis\n\nWith just a few lines, you can estimate genetic diversity across populations:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_diversity(arapat, stratum = \"Species\", mode = \"He\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Stratum Locus         He\n2       Cape  LTRS 0.14720000\n3       Cape   WNT 0.23374726\n4       Cape    EN 0.42000000\n5       Cape    EF 0.06444444\n6       Cape   ZMP 0.00000000\n7       Cape   AML 0.53312835\n8       Cape  ATPS 0.11546667\n9       Cape  MP20 0.36791111\n10  Mainland  LTRS 0.38850309\n11  Mainland   WNT 0.03277778\n12  Mainland    EN 0.50285714\n13  Mainland    EF 0.27119377\n14  Mainland   ZMP 0.09500000\n15  Mainland   AML 0.53854875\n16  Mainland  ATPS 0.25038580\n17  Mainland  MP20 0.80670340\n18 Peninsula  LTRS 0.42591805\n19 Peninsula   WNT 0.50613781\n20 Peninsula    EN 0.17229600\n21 Peninsula    EF 0.48979592\n22 Peninsula   ZMP 0.41492187\n23 Peninsula   AML 0.72842417\n24 Peninsula  ATPS 0.52255763\n25 Peninsula  MP20 0.69148800\n```\n\n\n:::\n:::\n\n\nOr compute population structure:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Gst\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3         EN 0.1823664 0.3678145 0.4498525 0.1823664\n4         EF 0.3653913 0.2772276 0.4368481 0.3653913\n5        ZMP 0.4961044 0.1712607 0.3398734 0.4961044\n6        AML 0.2723689 0.6045761 0.8308826 0.2723689\n7       ATPS 0.5856500 0.2983785 0.7201122 0.5856500\n8       MP20 0.2358115 0.6267430 0.8201419 0.2358115\n9 Multilocus 0.3835972 2.9284713 4.7509048        NA\n```\n\n\n:::\n:::\n\n\nThe following chapters cover each of these operations in detail.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}