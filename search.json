[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "gstudio: Spatial Analysis of Genetic Marker Data",
    "section": "",
    "text": "Preface\nThe gstudio package provides a comprehensive set of tools for the spatial analysis of genetic marker data in R. Originally developed to support research in landscape genetics and population genomics, it offers a unified framework for estimating genetic diversity, population structure, inter-individual and inter-population distances, relatedness, and population graph topology.\nAt the core of the package is the locus S3 class, a flexible representation of genotypes that supports codominant markers, SNPs, AFLPs, and allozymes. Built around this data type, gstudio provides four main analytical entry points — genetic_diversity(), genetic_structure(), genetic_distance(), and genetic_relatedness() — each dispatching to a range of estimators. Population Graphs, a graph-theoretic approach to understanding among-population connectivity (Dyer & Nason 2004), are fully integrated with construction, analysis, and visualization tools.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#who-this-book-is-for",
    "href": "index.html#who-this-book-is-for",
    "title": "gstudio: Spatial Analysis of Genetic Marker Data",
    "section": "Who This Book Is For",
    "text": "Who This Book Is For\nThis book is intended for population geneticists, landscape ecologists, and conservation biologists who want to analyze genetic marker data in R. It assumes basic familiarity with R and introductory population genetics concepts.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#how-to-use-this-book",
    "href": "index.html#how-to-use-this-book",
    "title": "gstudio: Spatial Analysis of Genetic Marker Data",
    "section": "How to Use This Book",
    "text": "How to Use This Book\nEach chapter is self-contained and can be read independently, though they build on each other sequentially. Code examples use live R execution, so you can follow along by running the code in your own R session.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#quick-start",
    "href": "index.html#quick-start",
    "title": "gstudio: Spatial Analysis of Genetic Marker Data",
    "section": "Quick Start",
    "text": "Quick Start\n\nlibrary(gstudio)\ndata(arapat)\nstr(arapat, max.level = 1)\n\n'data.frame':   363 obs. of  14 variables:\n $ Species   : Factor w/ 3 levels \"Cape\",\"Mainland\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ Cluster   : Factor w/ 5 levels \"CBP-C\",\"NBP-C\",..: 2 2 2 2 2 2 2 2 2 2 ...\n $ Population: Factor w/ 39 levels \"101\",\"102\",\"12\",..: 30 30 30 30 30 30 30 30 30 30 ...\n $ ID        : Factor w/ 363 levels \"101_10A\",\"101_1A\",..: 296 297 298 299 300 301 302 303 304 305 ...\n $ Latitude  : num  29.3 29.3 29.3 29.3 29.3 ...\n $ Longitude : num  -114 -114 -114 -114 -114 ...\n $ LTRS      : 'locus' chr  \"01:01\" \"01:01\" \"01:01\" \"01:01\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n $ WNT       : 'locus' chr  \"\" \"01:03\" \"01:03\" \"01:01\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n $ EN        : 'locus' chr  \"02:04\" \"01:01\" \"01:01\" \"01:02\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n $ EF        : 'locus' chr  \"01:02\" \"01:01\" \"01:01\" \"01:01\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n $ ZMP       : 'locus' chr  \"\" \"01:01\" \"01:01\" \"01:01\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n $ AML       : 'locus' chr  \"\" \"08:09\" \"08:09\" \"08:09\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n $ ATPS      : 'locus' chr  \"09:09\" \"09:09\" \"09:09\" \"09:09\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n $ MP20      : 'locus' chr  \"07:07\" \"07:07\" \"05:07\" \"07:07\" ...\n  ..- attr(*, \"locus_type\")= chr [1:363] \"codom\" \"codom\" \"codom\" \"codom\" ...\n\n\nThe arapat dataset contains multilocus microsatellite genotypes from the cactus beetle Araptus attenuatus and will serve as the primary example dataset throughout this book.\n\nhead(arapat)\n\n    Species Cluster Population     ID Latitude Longitude  LTRS   WNT    EN\n1 Peninsula   NBP-C         88 88_11A 29.32541 -114.2935 01:01       02:04\n2 Peninsula   NBP-C         88 88_12A 29.32541 -114.2935 01:01 01:03 01:01\n3 Peninsula   NBP-C         88 88_13A 29.32541 -114.2935 01:01 01:03 01:01\n4 Peninsula   NBP-C         88 88_14A 29.32541 -114.2935 01:01 01:01 01:02\n5 Peninsula   NBP-C         88 88_15A 29.32541 -114.2935 01:01 01:03 01:02\n6 Peninsula   NBP-C         88 88_16A 29.32541 -114.2935 01:01 01:01 01:02\n     EF   ZMP   AML  ATPS  MP20\n1 01:02             09:09 07:07\n2 01:01 01:01 08:09 09:09 07:07\n3 01:01 01:01 08:09 09:09 05:07\n4 01:01 01:01 08:09 09:09 07:07\n5 01:01 01:01 08:09 09:09 05:05\n6 01:01 01:01 09:09 09:09 07:07",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#citation",
    "href": "index.html#citation",
    "title": "gstudio: Spatial Analysis of Genetic Marker Data",
    "section": "Citation",
    "text": "Citation\nIf you use gstudio in your research, please cite:\n\nDyer, R.J. 2009. GStudio: a suite of tools for the spatial analysis of genetic marker data. Molecular Ecology Resources 9(1): 110-113.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#source-code",
    "href": "index.html#source-code",
    "title": "gstudio: Spatial Analysis of Genetic Marker Data",
    "section": "Source Code",
    "text": "Source Code\nThe source code for gstudio is available on GitHub at https://github.com/dyerlab/gstudio.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "getting-started.html",
    "href": "getting-started.html",
    "title": "1  Getting Started",
    "section": "",
    "text": "1.1 Installation\nThis chapter covers the installation of gstudio, loading bundled datasets, and a quick tour of the package’s core utilities.\nThe gstudio package is available from GitHub and can be installed using the devtools package:\ninstall.packages(\"devtools\")\ndevtools::install_github(\"dyerlab/gstudio\")\nOnce installed, load the package:\nlibrary(gstudio)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Getting Started</span>"
    ]
  },
  {
    "objectID": "getting-started.html#bundled-datasets",
    "href": "getting-started.html#bundled-datasets",
    "title": "1  Getting Started",
    "section": "1.2 Bundled Datasets",
    "text": "1.2 Bundled Datasets\nThe package ships with several datasets for examples and testing:\n\n\n\n\n\n\n\nDataset\nDescription\n\n\n\n\narapat\nAraptus attenuatus multilocus microsatellite data across Baja California\n\n\naflp_arapat\nAraptus attenuatus AFLP marker data\n\n\ncornus\nCornus florida adult genotypes\n\n\ncornus_florida\nCornus florida mother-offspring pair data\n\n\nlopho\nLophocereus schottii population graph (Dyer & Nason 2004)\n\n\nupiga\nUpiga virescens population graph\n\n\nbaja\nBaja California sampling location metadata\n\n\nalt\nSonoran desert altitude raster data\n\n\n\nLoad any dataset with the data() function:\n\ndata(arapat)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Getting Started</span>"
    ]
  },
  {
    "objectID": "getting-started.html#exploring-a-dataset",
    "href": "getting-started.html#exploring-a-dataset",
    "title": "1  Getting Started",
    "section": "1.3 Exploring a Dataset",
    "text": "1.3 Exploring a Dataset\nThe arapat dataset is a data.frame with both metadata columns and locus columns:\n\nnames(arapat)\n\n [1] \"Species\"    \"Cluster\"    \"Population\" \"ID\"         \"Latitude\"  \n [6] \"Longitude\"  \"LTRS\"       \"WNT\"        \"EN\"         \"EF\"        \n[11] \"ZMP\"        \"AML\"        \"ATPS\"       \"MP20\"      \n\ndim(arapat)\n\n[1] 363  14\n\n\n\n1.3.1 Identifying Locus Columns\nUse column_class() to find all columns of a particular class:\n\ncolumn_class(arapat, \"locus\")\n\n[1] \"LTRS\" \"WNT\"  \"EN\"   \"EF\"   \"ZMP\"  \"AML\"  \"ATPS\" \"MP20\"\n\n\nThis returns the names of all columns that contain locus objects — a function used extensively throughout the package.\n\n\n1.3.2 Splitting by Stratum\nThe partition() function splits a data.frame by a grouping column, returning a named list:\n\npops &lt;- partition(arapat, stratum = \"Species\")\nnames(pops)\n\n[1] \"Cape\"      \"Mainland\"  \"Peninsula\"\n\nsapply(pops, nrow)\n\n     Cape  Mainland Peninsula \n       75        36       252 \n\n\n\n\n1.3.3 Ploidy\nCheck the ploidy level of a locus column:\n\nploidy(arapat$LTRS)\n\n  [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n [38] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[223] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[260] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[297] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n[334] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Getting Started</span>"
    ]
  },
  {
    "objectID": "getting-started.html#a-quick-analysis",
    "href": "getting-started.html#a-quick-analysis",
    "title": "1  Getting Started",
    "section": "1.4 A Quick Analysis",
    "text": "1.4 A Quick Analysis\nWith just a few lines, you can estimate genetic diversity across populations:\n\ngenetic_diversity(arapat, stratum = \"Species\", mode = \"He\")\n\n     Stratum Locus         He\n2       Cape  LTRS 0.14720000\n3       Cape   WNT 0.23374726\n4       Cape    EN 0.42000000\n5       Cape    EF 0.06444444\n6       Cape   ZMP 0.00000000\n7       Cape   AML 0.53312835\n8       Cape  ATPS 0.11546667\n9       Cape  MP20 0.36791111\n10  Mainland  LTRS 0.38850309\n11  Mainland   WNT 0.03277778\n12  Mainland    EN 0.50285714\n13  Mainland    EF 0.27119377\n14  Mainland   ZMP 0.09500000\n15  Mainland   AML 0.53854875\n16  Mainland  ATPS 0.25038580\n17  Mainland  MP20 0.80670340\n18 Peninsula  LTRS 0.42591805\n19 Peninsula   WNT 0.50613781\n20 Peninsula    EN 0.17229600\n21 Peninsula    EF 0.48979592\n22 Peninsula   ZMP 0.41492187\n23 Peninsula   AML 0.72842417\n24 Peninsula  ATPS 0.52255763\n25 Peninsula  MP20 0.69148800\n\n\nOr compute population structure:\n\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Gst\")\n\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3         EN 0.1823664 0.3678145 0.4498525 0.1823664\n4         EF 0.3653913 0.2772276 0.4368481 0.3653913\n5        ZMP 0.4961044 0.1712607 0.3398734 0.4961044\n6        AML 0.2723689 0.6045761 0.8308826 0.2723689\n7       ATPS 0.5856500 0.2983785 0.7201122 0.5856500\n8       MP20 0.2358115 0.6267430 0.8201419 0.2358115\n9 Multilocus 0.3835972 2.9284713 4.7509048        NA\n\n\nThe following chapters cover each of these operations in detail.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Getting Started</span>"
    ]
  },
  {
    "objectID": "locus-class.html",
    "href": "locus-class.html",
    "title": "2  The Locus Class",
    "section": "",
    "text": "2.1 Creating Locus Objects\nThe locus is the fundamental data type in gstudio. It is an S3 class that stores a genotype as a colon-separated string of alleles. This chapter covers creating, manipulating, and converting locus objects.\nThe locus() constructor takes a vector of alleles and collapses them into a single genotype:\nloc &lt;- locus(c(\"A\", \"B\"))\nloc\n\n[1] \"A:B\"\nHomozygotes and higher-ploidy genotypes work the same way:\nlocus(c(\"A\", \"A\"))\n\n[1] \"A:A\"\n\nlocus(c(\"A\", \"B\", \"C\", \"D\"))\n\n[1] \"A:B:C:D\"",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#creating-locus-objects",
    "href": "locus-class.html#creating-locus-objects",
    "title": "2  The Locus Class",
    "section": "",
    "text": "2.1.1 Missing Data\nMissing data is represented as an empty string internally:\n\nloc_missing &lt;- locus()\nloc_missing\n\n[1] NA\n\nis.na(loc_missing)\n\n[1] TRUE",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#marker-types",
    "href": "locus-class.html#marker-types",
    "title": "2  The Locus Class",
    "section": "2.2 Marker Types",
    "text": "2.2 Marker Types\nThe type parameter controls how raw data is interpreted:\n\n2.2.1 Codominant (default)\nAlleles are sorted alphabetically and joined with ::\n\nlocus(c(\"B\", \"A\"), type = \"codom\")\n\n[1] \"A:B\"\n\n\n\n\n2.2.2 AFLP\nBinary presence/absence data (0 or 1):\n\nlocus(\"1\", type = \"aflp\")\n\n[1] \"1\"\n\nlocus(\"0\", type = \"aflp\")\n\n[1] \"0\"\n\n\n\n\n2.2.3 SNP\nEncoded as 0, 1, or 2 (count of minor alleles):\n\nlocus(\"0\", type = \"snp\")\n\n[1] \"A:A\"\n\nlocus(\"1\", type = \"snp\")\n\n[1] \"A:B\"\n\nlocus(\"2\", type = \"snp\")\n\n[1] \"B:B\"\n\n\n\n\n2.2.4 Separated\nPre-formatted colon-separated strings:\n\nlocus(\"A:B\", type = \"separated\")\n\n[1] \"A:B\"\n\n\n\n\n2.2.5 Zyme (allozyme)\nAlleles encoded as concatenated integers (e.g., “12” = alleles 1 and 2):\n\nlocus(\"12\", type = \"zyme\")\n\n[1] \"1:2\"\n\nlocus(\"23\", type = \"zyme\")\n\n[1] \"2:3\"\n\n\n\n\n2.2.6 Column\nTwo-column matrix format (used internally by read_population()):\n\nalleles_mat &lt;- cbind(c(\"A\", \"B\", \"C\"), c(\"B\", \"A\", \"C\"))\nlocus(alleles_mat, type = \"column\")\n\n[1] \"A:B\" \"A:B\" \"C:C\"",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#working-with-vectors-of-loci",
    "href": "locus-class.html#working-with-vectors-of-loci",
    "title": "2  The Locus Class",
    "section": "2.3 Working with Vectors of Loci",
    "text": "2.3 Working with Vectors of Loci\nGenotype vectors are created using c():\n\nAA &lt;- locus(c(\"A\", \"A\"))\nAB &lt;- locus(c(\"A\", \"B\"))\nBB &lt;- locus(c(\"B\", \"B\"))\nloci &lt;- c(AA, AB, AB, AA, BB)\nloci\n\n[1] \"A:A\" \"A:B\" \"A:B\" \"A:A\" \"B:B\"\n\n\n\n2.3.1 Indexing\n\nloci[2]\n\n[1] \"A:B\"\n\nloci[c(1, 3, 5)]\n\n[1] \"A:A\" \"A:B\" \"B:B\"\n\n\n\n\n2.3.2 Replication\n\nrep(AB, times = 3)\n\n[1] \"A:B\" \"A:B\" \"A:B\"",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#extracting-alleles",
    "href": "locus-class.html#extracting-alleles",
    "title": "2  The Locus Class",
    "section": "2.4 Extracting Alleles",
    "text": "2.4 Extracting Alleles\nThe alleles() function returns the component alleles:\n\nalleles(AB)\n\n[1] \"A\" \"B\"\n\nalleles(loci)\n\n     [,1] [,2]\n[1,] \"A\"  \"A\" \n[2,] \"A\"  \"B\" \n[3,] \"A\"  \"B\" \n[4,] \"A\"  \"A\" \n[5,] \"B\"  \"B\"",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#heterozygosity-testing",
    "href": "locus-class.html#heterozygosity-testing",
    "title": "2  The Locus Class",
    "section": "2.5 Heterozygosity Testing",
    "text": "2.5 Heterozygosity Testing\n\nis_heterozygote(AA)\n\n[1] FALSE\n\nis_heterozygote(AB)\n\n[1] TRUE\n\nis_heterozygote(loci)\n\n[1] FALSE  TRUE  TRUE FALSE FALSE",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#operator-overloads",
    "href": "locus-class.html#operator-overloads",
    "title": "2  The Locus Class",
    "section": "2.6 Operator Overloads",
    "text": "2.6 Operator Overloads\n\n2.6.1 Mating (+)\nThe + operator simulates mating by randomly sampling one allele from each parent:\n\ndad &lt;- locus(c(\"A\", \"A\"))\nmom &lt;- locus(c(\"B\", \"B\"))\nset.seed(42)\noffspring &lt;- mom + dad\noffspring\n\n[1] \"A:B\"\n\n\n\n\n2.6.2 Parental Subtraction (-)\nThe - operator removes the maternal contribution from an offspring genotype:\n\noff &lt;- locus(c(\"A\", \"B\"))\nmom &lt;- locus(c(\"A\", \"A\"))\npaternal_gamete &lt;- off - mom\npaternal_gamete\n\n[1] \"B\"\n\n\nThis is useful in parentage analysis for identifying the paternal allelic contribution.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#coercion",
    "href": "locus-class.html#coercion",
    "title": "2  The Locus Class",
    "section": "2.7 Coercion",
    "text": "2.7 Coercion\n\n2.7.1 To Data Frame\n\nas.data.frame(loci)\n\n  loci\n1  A:A\n2  A:B\n3  A:B\n4  A:A\n5  B:B\n\n\n\n\n2.7.2 From Other Types\n\nas.locus(c(\"A\", \"B\"))\n\n[1] \"A:B\"\n\nas.locus(list(\"C\", \"D\"))\n\n[1] \"C:D\"\n\n\n\n\n2.7.3 Is-a Test\n\nis.locus(AB)\n\n[1] TRUE\n\nis.locus(\"not a locus\")\n\n[1] FALSE",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "locus-class.html#multivariate-conversion",
    "href": "locus-class.html#multivariate-conversion",
    "title": "2  The Locus Class",
    "section": "2.8 Multivariate Conversion",
    "text": "2.8 Multivariate Conversion\nThe to_mv() function converts locus data to a multivariate numeric format suitable for ordination and graph analysis:\n\ndata(arapat)\nmv &lt;- to_mv(arapat)\ndim(mv)\n\n[1] 363  58\n\nmv[1:5, 1:6]\n\n     01 02  01 02  03 04\n[1,]  1  0 0.0  0 0.0  0\n[2,]  1  0 0.5  0 0.5  0\n[3,]  1  0 0.5  0 0.5  0\n[4,]  1  0 1.0  0 0.0  0\n[5,]  1  0 0.5  0 0.5  0\n\n\nEach allele at each locus becomes a column, with values representing allele counts (0, 1, or 2 for diploids). This is the input format for popgraph().",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Locus Class</span>"
    ]
  },
  {
    "objectID": "data-io.html",
    "href": "data-io.html",
    "title": "3  Importing & Exporting Data",
    "section": "",
    "text": "3.1 Reading Population Data\nThis chapter covers reading genetic data from files, converting between formats, and generating synthetic populations.\nThe read_population() function is the primary data import tool. It reads text files and converts specified columns to locus objects.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Importing & Exporting Data</span>"
    ]
  },
  {
    "objectID": "data-io.html#reading-population-data",
    "href": "data-io.html#reading-population-data",
    "title": "3  Importing & Exporting Data",
    "section": "",
    "text": "3.1.1 Function Signature\n\nread_population(path, type, locus.columns, phased = FALSE,\n                sep = \",\", header = TRUE, delim = \":\")\n\nThe key parameters:\n\npath — file path to the data\ntype — marker encoding format\nlocus.columns — integer vector indicating which columns contain genetic data\n\n\n\n3.1.2 Separated Format\nThe most common format uses colon-separated alleles (e.g., \"A:B\"):\n\npath &lt;- system.file(\"extdata\", \"data_separated.csv\", package = \"gstudio\")\ndata_sep &lt;- read_population(path, type = \"separated\",\n                            locus.columns = c(4, 5))\nhead(data_sep)\n\n  Population Latitude Longitude  Loc1  Loc2\n1    Olympia    47.15   -122.89 12:14 15:15\n2 Bellingham    48.75   -122.49 12:12 15:17\n3  St. Louis    38.81    -89.98 10:12      \n4       Ames    42.26    -93.47 10:14      \n5   Richmond    37.74    -77.16 10:10 17:17\n\n\n\n\n3.1.3 Column Format\nTwo adjacent columns per locus (one column per allele):\n\npath &lt;- system.file(\"extdata\", \"data_2_column.csv\", package = \"gstudio\")\ndata_col &lt;- read_population(path, type = \"column\",\n                            locus.columns = c(4:7))\nhead(data_col)\n\n  Population Latitude Longitude  Loc1  Loc2\n1    Olympia    47.15   -122.89 12:14 15:15\n2 Bellingham    48.75   -122.49 12:12 15:17\n3  St. Louis    38.81    -89.98 10:12      \n4       Ames    42.26    -93.47 10:14      \n5   Richmond    37.74    -77.16 10:10 17:17\n\n\n\n\n3.1.4 SNP Format\nEncoded as 0, 1, 2 (minor allele count):\n\npath &lt;- system.file(\"extdata\", \"data_snp.csv\", package = \"gstudio\")\ndata_snp &lt;- read_population(path, type = \"snp\",\n                            locus.columns = c(4:7))\nhead(data_snp)\n\n  Population Latitude Longitude snp1 snp2 snp3 snp4\n1    Olympia    47.15   -122.89  A:B  B:B  A:B  A:B\n2 Bellingham    48.75   -122.49  A:B  A:A  A:B  B:B\n3  St. Louis    38.81    -89.98  A:B  A:A          \n4       Ames    42.26    -93.47  A:A  A:B          \n5   Richmond    37.74    -77.16  A:A  B:B  A:B  B:B\n\n\n\n\n3.1.5 AFLP Format\nBinary (0/1) presence-absence:\n\npath &lt;- system.file(\"extdata\", \"data_aflp.csv\", package = \"gstudio\")\ndata_aflp &lt;- read_population(path, type = \"aflp\",\n                             locus.columns = c(4:7))\nhead(data_aflp)\n\n  Population Latitude Longitude Loc1 Loc2 Loc3 Loc4\n1    Olympia    47.15   -122.89    1    1    1    1\n2 Bellingham    48.75   -122.49    0    0    1    0\n3  St. Louis    38.81    -89.98    1    0          \n4       Ames    42.26    -93.47    0    1          \n5   Richmond    37.74    -77.16    0    0    1    1\n\n\n\n\n3.1.6 Allozyme (Zyme) Format\nConcatenated integer alleles (e.g., “12” for alleles 1 and 2):\n\npath &lt;- system.file(\"extdata\", \"data_zymelike.csv\", package = \"gstudio\")\ndata_zyme &lt;- read_population(path, type = \"zyme\",\n                             locus.columns = c(4:7))\nhead(data_zyme)\n\n  Population Latitude Longitude Loc1 Loc2 Loc3 Loc4\n1    Olympia    47.15   -122.89  1:2  1:4  1:5  1:5\n2 Bellingham    48.75   -122.49  1:2  1:2  1:5  1:7\n3  St. Louis    38.81    -89.98  1:2  1:3          \n4       Ames    42.26    -93.47  1:1  1:4          \n5   Richmond    37.74    -77.16  1:2  1:1  2:2  2:2\n\n\n\n\n3.1.7 Genepop Format\nGenepop files have their own structure with Pop delimiters:\n\npath &lt;- system.file(\"extdata\", \"genepop.txt\", package = \"gstudio\")\ndata_gp &lt;- read_population(path, type = \"genepop\")\nhead(data_gp)\n\n   Population              ID Locus_A Locus_B Locus_C Locus_D Locus_E Locus_F\n16      Pop-1  Population-1.1 178:182 224:224 235:239 191:193 191:197 185:189\n17      Pop-1 Population-1.10 174:178 224:224 235:239 191:191 191:191 185:189\n18      Pop-1 Population-1.11 174:186 216:216 235:239 191:191 191:197 185:189\n19      Pop-1 Population-1.12 178:186 224:224 235:238 191:191 191:191 185:185\n20      Pop-1 Population-1.13 174:190 224:224 235:239 191:191 191:191 185:189\n21      Pop-1 Population-1.14 174:178 216:216 231:239 191:191 191:191 181:189\n   Locus_G Locus_H Locus_I Locus_J Locus_K Locus_L Locus_M\n16 223:223 187:190 131:160 232:232 257:257 184:184 243:268\n17 223:223 187:187 131:160 232:252 261:261 184:184 268:268\n18 223:223 187:187 131:131 232:232 257:261 182:182 243:268\n19 223:223 187:187 131:131 232:236 261:261 182:182 243:243\n20 231:231 187:187 131:160 228:232 257:261 182:182 243:243\n21 223:223 187:187         228:252 257:261 182:184 243:268\n\n\n\n\n3.1.8 Structure Format\nTwo-row-per-individual STRUCTURE format:\n\npath &lt;- system.file(\"extdata\", \"data_structure.str\", package = \"gstudio\")\ndata_str &lt;- read_population(path, type = \"structure\")\nhead(data_str)\n\n  Population ID    LOC1  LOC1.1    LOC3    LOC4    LOC5    LOC6    LOC7    LOC8\n1          1 01 103:103 104:104 105:107 105:109 103:103 105:107 102:102 103:103\n2          1 01 103:103 104:104 105:107 105:109 103:103 105:107 102:102 103:103\n3          1 02 103:104 103:103 105:107 107:107 103:103 105:107 102:102 103:103\n4          1 02 103:104 103:103 105:107 107:107 103:103 105:107 102:102 103:103\n5          1 03 103:104 103:103 105:107 107:107 103:103 107:107 102:102 103:105\n6          1 03 103:104 103:103 105:107 107:107 103:103 107:107 102:102 103:105\n     LOC9   LOC10   LOC11   LOC12   LOC13   LOC14   LOC15\n1 104:104 103:103 102:105 102:108 102:104 105:105 103:103\n2 104:104 103:103 102:105 102:108 102:104 105:105 103:103\n3 104:104 103:103 105:105 105:108 102:104 105:105 103:103\n4 104:104 103:103 105:105 105:108 102:104 105:105 103:103\n5 104:104 103:103 102:105 105:108 102:105 105:105 103:105\n6 104:104 103:103 102:105 105:108 102:105 105:105 103:105",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Importing & Exporting Data</span>"
    ]
  },
  {
    "objectID": "data-io.html#writing-population-data",
    "href": "data-io.html#writing-population-data",
    "title": "3  Importing & Exporting Data",
    "section": "3.2 Writing Population Data",
    "text": "3.2 Writing Population Data\nThe write_population() function exports a data.frame to various formats:\n\n# Plain text (colon-separated loci)\nwrite_population(arapat, file = \"arapat.csv\")\n\n# Genepop format\nwrite_population(arapat, file = \"arapat.gen\",\n                 mode = \"genepop\", stratum = \"Species\")\n\n# Structure format\nwrite_population(arapat, file = \"arapat.str\",\n                 mode = \"structure\", stratum = \"Species\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Importing & Exporting Data</span>"
    ]
  },
  {
    "objectID": "data-io.html#direct-format-conversion",
    "href": "data-io.html#direct-format-conversion",
    "title": "3  Importing & Exporting Data",
    "section": "3.3 Direct Format Conversion",
    "text": "3.3 Direct Format Conversion\nYou can also convert data.frames directly without writing to disk:\n\ndata(arapat)\ngp &lt;- to_genepop(arapat, stratum = \"Species\")\ncat(gp[1:10], sep = \"\\n\")\n\nData.frame exported from gstudio R package\n          LTRS, WNT, EN, EF, ZMP, AML, ATPS, MP20\nPOP\nCape, 0101 0202 0102 0101 0202 0304 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0102 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0101 0101 0202 0303 0303 1919\nCape, 0202 0202 0101 0101 0202 0404 0303 1818\nCape, 0102 0101 0101 0102 0000 0000 0909 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1819\nCape, 0202 0202 0102 0101 0202 0304 0303 1818\nCape, 0202 0202 0202 0101 0202 0303 0303 1818\nCape, 0202 0202 0202 0101 0202 0304 0303 1818\nCape, 0202 0202 0101 0101 0202 0404 0303 1818\nCape, 0101 0102 0102 0101 0202 0304 0303 1818\nCape, 0202 0202 0202 0101 0202 0305 0303 1818\nCape, 0202 0202 0101 0101 0202 0505 0303 1819\nCape, 0102 0000 0101 0202 0000 0000 0303 1818\nCape, 0202 0202 0102 0102 0000 0000 0202 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0202 0102 0101 0202 0505 0303 1718\nCape, 0202 0202 0102 0101 0202 0505 0303 1717\nCape, 0102 0202 0101 0102 0000 0000 0303 1718\nCape, 0202 0202 0102 0101 0202 0404 0303 1717\nCape, 0202 0202 0102 0101 0202 0505 0303 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0305 0303 1818\nCape, 0102 0202 0202 0101 0202 0305 0303 1818\nCape, 0102 0202 0202 0101 0202 0303 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0505 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0102 0102 0101 0202 0404 0303 1818\nCape, 0202 0102 0102 0101 0202 0404 0303 1717\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0101 1717\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1718\nCape, 0202 0202 0202 0101 0202 0404 0303 1717\nCape, 0202 0202 0202 0101 0202 0505 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0505 0303 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1717\nCape, 0202 0202 0102 0101 0202 0404 0306 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0101 0202 0101 0202 0404 0303 1617\nCape, 0202 0202 0202 0101 0202 0505 0303 1718\nCape, 0202 0202 0202 0101 0202 0505 0303 1718\nCape, 0202 0202 0102 0101 0202 0404 0303 1718\nCape, 0202 0202 0102 0101 0202 0404 0306 1717\nCape, 0202 0202 0102 0101 0202 0404 0306 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1718\nCape, 0202 0202 0202 0101 0202 0404 0303 1717\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0202 0102 0101 0202 0505 0303 1819\nCape, 0202 0202 0102 0101 0202 0505 0303 1717\nCape, 0202 0202 0102 0101 0000 0505 0303 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0202 0102 0101 0202 0404 0303 1818\nCape, 0202 0202 0102 0101 0202 0505 0303 1818\nCape, 0202 0202 0102 0101 0202 0505 0303 1818\nCape, 0102 0202 0102 0101 0202 0505 0303 1818\nCape, 0102 0202 0101 0101 0202 0404 0303 1819\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0202 0202 0101 0202 0404 0303 1818\nCape, 0202 0101 0202 0101 0202 0404 0303 1818\nCape, 0202 0102 0202 0101 0202 0404 0303 1818\nCape, 0202 0101 0202 0101 0202 0505 0303 1718\nCape, 0202 0101 0202 0101 0202 0505 0303 1818\nCape, 0202 0101 0202 0101 0202 0505 0303 1818\nCape, 0202 0101 0202 0101 0202 0505 0303 1818\nCape, 0202 0101 0202 0101 0202 0505 0303 1818\nPOP\nMainland, 0102 0000 0101 0000 0000 0000 0202 0000\nMainland, 0202 0101 0101 0101 0000 0000 0202 1313\nMainland, 0102 0000 0101 0102 0000 0000 0909 0000\nMainland, 0202 0101 0303 0102 0101 1111 0202 1314\nMainland, 0102 0101 0101 0102 0000 0808 0404 1212\nMainland, 0102 0101 0303 0102 0000 0000 0202 1212\nMainland, 0202 0101 0303 0101 0000 0000 0202 0212\nMainland, 0102 0000 0101 0000 0000 0000 0209 0000\nMainland, 0202 0101 0103 0101 0000 0000 0209 1112\nMainland, 0102 0103 0101 0102 0202 0000 0202 1213\nMainland, 0202 0101 0303 0101 0202 1111 0204 1313\nMainland, 0202 0101 0304 0101 0202 1111 0202 0312\nMainland, 0102 0101 0303 0101 0202 1111 0202 0313\nMainland, 0202 0101 0303 0101 0202 1111 0202 1212\nMainland, 0202 0101 0303 0101 0202 1111 0202 1213\nMainland, 0102 0101 0303 0101 0202 1111 0202 0214\nMainland, 0202 0101 0303 0101 0202 1212 0203 1212\nMainland, 0202 0101 0303 0101 0202 1212 0202 1313\nMainland, 0202 0101 0303 0101 0202 1111 0202 0210\nMainland, 0101 0101 0304 0101 0202 1212 0202 1113\nMainland, 0102 0101 0304 0101 0202 0812 0204 0112\nMainland, 0102 0101 0404 0101 0202 1111 0202 0313\nMainland, 0202 0101 0304 0101 0202 1011 0202 1111\nMainland, 0102 0101 0303 0101 0202 1212 0202 1013\nMainland, 0202 0101 0303 0101 0202 1212 0202 0210\nMainland, 0102 0101 0304 0101 0202 0811 0202 0214\nMainland, 0202 0101 0303 0101 0202 1111 0202 0313\nMainland, 0202 0101 0304 0101 0202 1111 0202 1112\nMainland, 0202 0000 0103 0102 0000 0000 0209 0909\nMainland, 0102 0101 0303 0102 0000 0000 0202 0312\nMainland, 0102 0000 0000 0102 0000 0000 0202 0205\nMainland, 0102 0101 0303 0101 0000 0000 0202 1112\nMainland, 0102 0000 0303 0102 0000 1111 0202 1113\nMainland, 0202 0101 0101 0101 0000 0000 0202 1212\nMainland, 0102 0101 0303 0102 0000 0000 0202 1212\nMainland, 0202 0101 0303 0102 0000 0000 0202 0313\nPOP\nPeninsula, 0101 0000 0204 0102 0000 0000 0909 0707\nPeninsula, 0101 0103 0101 0101 0101 0809 0909 0707\nPeninsula, 0101 0103 0101 0101 0101 0809 0909 0507\nPeninsula, 0101 0101 0102 0101 0101 0809 0909 0707\nPeninsula, 0101 0103 0102 0101 0101 0809 0909 0505\nPeninsula, 0101 0101 0102 0101 0101 0909 0909 0707\nPeninsula, 0101 0101 0102 0101 0101 0709 0909 0507\nPeninsula, 0101 0101 0102 0101 0101 0707 0909 0507\nPeninsula, 0101 0103 0102 0101 0101 0910 0909 0707\nPeninsula, 0101 0101 0101 0101 0102 0708 0909 0707\nPeninsula, 0101 0101 0102 0101 0101 0609 0909 0707\nPeninsula, 0101 0101 0102 0101 0101 0909 0909 0707\nPeninsula, 0101 0101 0102 0101 0101 0909 0909 0707\nPeninsula, 0101 0101 0102 0101 0101 0606 0909 0707\nPeninsula, 0101 0103 0102 0101 0101 0909 0709 0507\nPeninsula, 0101 0101 0101 0101 0101 0909 0909 0707\nPeninsula, 0101 0103 0101 0101 0101 0910 0509 0707\nPeninsula, 0101 0101 0102 0101 0101 0709 0909 0707\nPeninsula, 0101 0103 0101 0101 0101 0909 0909 0707\nPeninsula, 0101 0103 0101 0101 0101 0909 0909 0507\nPeninsula, 0101 0101 0101 0101 0102 0809 0909 0515\nPeninsula, 0101 0101 0102 0101 0101 0709 0709 0707\nPeninsula, 0101 0000 0101 0102 0000 0000 0509 0707\nPeninsula, 0101 0101 0105 0101 0101 0707 0909 0707\nPeninsula, 0101 0101 0101 0101 0101 0909 0909 0707\nPeninsula, 0101 0101 0102 0101 0101 0709 0909 0505\nPeninsula, 0101 0101 0102 0101 0101 0909 0909 0507\nPeninsula, 0101 0103 0105 0101 0101 0909 0709 0707\nPeninsula, 0101 0101 0102 0101 0102 0809 0909 0507\nPeninsula, 0101 0101 0102 0101 0101 0909 0909 0507\nPeninsula, 0101 0101 0101 0101 0202 0909 0909 0505\nPeninsula, 0101 0103 0101 0101 0102 0609 0909 0707\nPeninsula, 0101 0101 0101 0101 0202 0809 0909 0507\nPeninsula, 0101 0101 0101 0101 0202 0808 0909 0707\nPeninsula, 0101 0303 0102 0101 0202 0910 0909 0507\nPeninsula, 0101 0103 0101 0101 0202 0707 0909 0507\nPeninsula, 0101 0101 0101 0101 0202 0609 0909 0507\nPeninsula, 0101 0103 0101 0101 0202 0709 0909 0707\nPeninsula, 0101 0103 0101 0101 0102 0608 0909 0707\nPeninsula, 0101 0101 0101 0101 0202 0809 0909 0707\nPeninsula, 0101 0103 0101 0101 0101 0910 0909 0707\nPeninsula, 0101 0103 0102 0101 0101 0909 0909 0707\nPeninsula, 0101 0101 0102 0101 0102 0609 0909 0707\nPeninsula, 0101 0101 0102 0101 0101 0909 0909 0505\nPeninsula, 0101 0101 0102 0101 0101 0709 0909 0508\nPeninsula, 0101 0303 0101 0101 0202 0808 0710 0707\nPeninsula, 0101 0303 0101 0101 0202 0909 0909 0707\nPeninsula, 0101 0303 0101 0101 0202 0708 0909 0507\nPeninsula, 0102 0303 0101 0101 0102 0709 0909 0505\nPeninsula, 0101 0303 0101 0101 0101 0708 0909 0607\nPeninsula, 0101 0303 0101 0101 0202 0707 0709 0507\nPeninsula, 0102 0303 0103 0101 0101 0707 0709 0507\nPeninsula, 0101 0103 0101 0101 0202 0808 0909 0507\nPeninsula, 0101 0303 0103 0101 0102 0809 0909 0407\nPeninsula, 0101 0103 0101 0101 0202 0808 0909 0607\nPeninsula, 0101 0303 0101 0101 0000 0809 0909 0506\nPeninsula, 0101 0101 0102 0101 0202 0709 0709 0505\nPeninsula, 0101 0103 0101 0101 0202 0808 0909 0507\nPeninsula, 0101 0101 0101 0101 0202 0707 0909 0505\nPeninsula, 0101 0103 0101 0101 0202 0909 0909 0707\nPeninsula, 0101 0103 0303 0101 0202 0808 0909 0505\nPeninsula, 0102 0303 0101 0101 0102 0708 0909 0707\nPeninsula, 0102 0103 0101 0101 0202 0808 0709 0707\nPeninsula, 0101 0103 0101 0101 0102 0809 0909 0707\nPeninsula, 0101 0103 0101 0101 0202 0808 0909 0507\nPeninsula, 0101 0303 0103 0101 0202 0709 0910 0507\nPeninsula, 0101 0303 0101 0101 0202 0909 0910 0507\nPeninsula, 0101 0303 0303 0101 0202 0809 0709 0708\nPeninsula, 0102 0303 0101 0101 0000 0710 0909 0707\nPeninsula, 0101 0303 0305 0101 0202 0708 0709 0507\nPeninsula, 0101 0303 0101 0101 0202 0809 0707 0507\nPeninsula, 0102 0303 0101 0101 0202 0709 0709 0507\nPeninsula, 0101 0303 0101 0101 0202 0709 0909 0507\nPeninsula, 0101 0303 0101 0101 0202 0707 0709 0507\nPeninsula, 0101 0103 0101 0101 0202 0707 0909 0707\nPeninsula, 0101 0103 0103 0101 0202 0809 0909 0507\nPeninsula, 0101 0103 0205 0101 0202 0708 0909 0407\nPeninsula, 0101 0103 0101 0101 0202 0708 0709 0507\nPeninsula, 0101 0103 0101 0101 0202 0811 0709 0507\nPeninsula, 0102 0103 0101 0101 0202 0808 0909 0407\nPeninsula, 0102 0303 0101 0101 0202 0708 0909 0507\nPeninsula, 0101 0303 0101 0102 0202 0809 0909 0507\nPeninsula, 0101 0303 0101 0101 0202 0809 0909 0507\nPeninsula, 0101 0303 0303 0101 0202 0808 0709 0507\nPeninsula, 0101 0303 0101 0102 0202 0707 0505 0507\nPeninsula, 0101 0303 0101 0202 0202 0608 0505 0507\nPeninsula, 0102 0303 0101 0102 0202 0809 0505 0707\nPeninsula, 0101 0303 0101 0102 0102 0708 0505 0607\nPeninsula, 0102 0303 0101 0102 0202 0707 0505 0505\nPeninsula, 0202 0303 0101 0202 0202 0607 0505 0707\nPeninsula, 0101 0103 0101 0102 0202 0909 0505 0507\nPeninsula, 0101 0103 0101 0102 0202 0808 0505 0708\nPeninsula, 0101 0303 0101 0202 0202 0707 0505 0707\nPeninsula, 0101 0303 0101 0202 0101 0808 0505 0607\nPeninsula, 0101 0303 0101 0202 0202 0709 0507 0506\nPeninsula, 0102 0303 0101 0202 0202 0909 0505 0505\nPeninsula, 0101 0303 0101 0101 0202 0909 0505 0507\nPeninsula, 0101 0103 0101 0202 0202 0209 0505 0408\nPeninsula, 0102 0303 0101 0202 0202 0707 0505 0505\nPeninsula, 0101 0104 0101 0101 0202 0808 0505 0506\nPeninsula, 0202 0303 0101 0202 0102 0708 0505 0708\nPeninsula, 0101 0101 0101 0101 0202 0607 0505 0505\nPeninsula, 0101 0303 0101 0102 0101 0708 0505 0707\nPeninsula, 0101 0101 0101 0101 0000 0707 0505 0606\nPeninsula, 0101 0103 0101 0101 0202 0713 0505 0505\nPeninsula, 0101 0303 0101 0102 0202 0808 0505 0707\nPeninsula, 0102 0101 0101 0202 0000 0708 0505 0606\nPeninsula, 0101 0303 0103 0202 0202 0708 0505 0507\nPeninsula, 0101 0103 0101 0101 0202 0808 0505 0608\nPeninsula, 0101 0103 0101 0102 0000 0707 0507 0506\nPeninsula, 0101 0303 0101 0202 0102 0808 0505 0507\nPeninsula, 0101 0101 0101 0202 0202 0707 0505 0507\nPeninsula, 0101 0103 0101 0101 0202 0507 0505 0506\nPeninsula, 0101 0103 0101 0101 0102 0810 0505 0505\nPeninsula, 0102 0103 0101 0202 0202 0707 0505 0507\nPeninsula, 0101 0103 0101 0202 0202 0708 0505 0508\nPeninsula, 0101 0303 0101 0202 0102 0808 0505 0406\nPeninsula, 0102 0303 0101 0202 0102 0808 0505 0507\nPeninsula, 0101 0103 0101 0202 0202 0808 0505 0707\nPeninsula, 0102 0103 0101 0101 0202 0607 0505 0505\nPeninsula, 0101 0303 0101 0101 0102 0107 0505 0708\nPeninsula, 0102 0103 0101 0101 0202 0707 0505 0506\nPeninsula, 0101 0303 0101 0102 0202 0808 0505 0505\nPeninsula, 0101 0303 0101 0102 0202 0709 0505 0507\nPeninsula, 0101 0103 0101 0102 0202 0809 0505 0406\nPeninsula, 0101 0303 0101 0102 0202 0708 0505 0607\nPeninsula, 0101 0303 0101 0102 0000 0708 0505 0506\nPeninsula, 0101 0103 0101 0202 0202 0808 0505 0508\nPeninsula, 0101 0103 0101 0102 0202 0808 0505 0506\nPeninsula, 0101 0103 0101 0102 0202 0709 0505 0608\nPeninsula, 0102 0103 0101 0202 0202 0708 0505 0707\nPeninsula, 0101 0304 0101 0202 0202 0810 0505 0508\nPeninsula, 0101 0101 0101 0102 0202 0708 0505 0507\nPeninsula, 0102 0303 0101 0101 0202 0707 0505 0708\nPeninsula, 0102 0303 0101 0101 0102 0609 0505 0506\nPeninsula, 0101 0303 0101 0102 0202 0709 0505 0507\nPeninsula, 0102 0303 0101 0202 0202 0708 0505 0606\nPeninsula, 0101 0103 0101 0102 0202 0808 0505 0607\nPeninsula, 0102 0303 0101 0102 0202 0708 0505 0507\nPeninsula, 0101 0303 0101 0102 0202 0808 0505 0505\nPeninsula, 0101 0101 0101 0202 0102 0808 0505 0505\nPeninsula, 0102 0303 0101 0101 0000 0809 0505 0707\nPeninsula, 0102 0101 0101 0202 0000 0808 0505 0505\nPeninsula, 0101 0303 0101 0102 0202 0808 0505 0606\nPeninsula, 0102 0103 0101 0101 0102 0710 0505 0707\nPeninsula, 0101 0101 0104 0202 0202 0708 0505 0507\nPeninsula, 0101 0104 0104 0202 0101 0708 0505 0607\nPeninsula, 0102 0101 0101 0101 0202 0708 0505 0507\nPeninsula, 0102 0101 0101 0202 0102 0707 0505 0506\nPeninsula, 0202 0104 0101 0202 0202 0808 0505 0508\nPeninsula, 0102 0304 0101 0102 0202 0710 0505 0505\nPeninsula, 0101 0103 0101 0202 0102 0808 0505 0506\nPeninsula, 0101 0303 0101 0202 0202 0709 0505 0506\nPeninsula, 0101 0104 0101 0202 0202 0707 0505 0505\nPeninsula, 0102 0303 0101 0102 0102 0707 0505 0505\nPeninsula, 0102 0303 0101 0202 0202 0708 0505 0507\nPeninsula, 0101 0304 0101 0202 0102 0708 0505 0506\nPeninsula, 0101 0103 0101 0102 0202 0709 0505 0505\nPeninsula, 0102 0304 0101 0101 0102 0808 0505 0507\nPeninsula, 0101 0303 0101 0102 0102 0809 0505 0507\nPeninsula, 0102 0103 0101 0102 0102 0707 0505 0707\nPeninsula, 0102 0103 0101 0102 0202 0708 0505 0508\nPeninsula, 0202 0101 0101 0202 0202 0809 0505 0507\nPeninsula, 0202 0303 0101 0202 0202 0707 0505 0507\nPeninsula, 0202 0103 0101 0202 0102 0909 0505 0507\nPeninsula, 0102 0103 0101 0202 0102 0808 0505 0505\nPeninsula, 0102 0303 0101 0202 0202 0707 0505 0507\nPeninsula, 0102 0303 0101 0202 0102 0808 0505 0507\nPeninsula, 0202 0101 0101 0202 0102 0809 0505 0505\nPeninsula, 0202 0303 0101 0202 0202 0707 0505 0508\nPeninsula, 0102 0303 0101 0202 0202 0707 0505 0505\nPeninsula, 0202 0303 0101 0202 0202 0708 0505 0507\nPeninsula, 0202 0103 0101 0101 0202 0709 0505 0505\nPeninsula, 0101 0303 0101 0202 0202 0509 0505 0508\nPeninsula, 0101 0103 0101 0202 0202 0708 0505 0606\nPeninsula, 0101 0103 0101 0202 0101 0808 0505 0505\nPeninsula, 0102 0303 0101 0202 0202 0708 0505 0508\nPeninsula, 0102 0303 0101 0202 0202 0708 0505 0507\nPeninsula, 0101 0303 0101 0202 0202 0505 0505 0507\nPeninsula, 0101 0303 0101 0202 0102 0707 0505 0505\nPeninsula, 0102 0303 0101 0202 0102 0707 0505 0707\nPeninsula, 0101 0103 0101 0202 0102 0707 0505 0707\nPeninsula, 0101 0103 0101 0202 0101 0606 0505 0707\nPeninsula, 0101 0103 0101 0202 0102 0608 0505 0707\nPeninsula, 0202 0103 0101 0202 0101 0707 0505 0707\nPeninsula, 0101 0303 0101 0202 0101 0708 0505 0507\nPeninsula, 0101 0103 0101 0202 0101 0709 0505 0607\nPeninsula, 0102 0303 0104 0202 0101 0707 0505 0606\nPeninsula, 0102 0303 0104 0202 0102 0708 0505 0707\nPeninsula, 0102 0303 0101 0202 0102 0709 0505 0607\nPeninsula, 0101 0303 0101 0202 0101 0808 0505 0506\nPeninsula, 0101 0304 0101 0202 0101 0808 0505 0507\nPeninsula, 0101 0304 0101 0202 0102 0709 0505 0707\nPeninsula, 0102 0103 0101 0202 0202 0808 0505 0505\nPeninsula, 0102 0103 0101 0202 0102 0707 0505 0606\nPeninsula, 0202 0305 0101 0202 0102 0808 0505 0505\nPeninsula, 0202 0305 0101 0202 0202 0607 0505 0507\nPeninsula, 0202 0304 0101 0202 0102 0808 0505 0506\nPeninsula, 0102 0303 0101 0202 0102 0708 0505 0505\nPeninsula, 0202 0303 0101 0202 0102 0707 0505 0505\nPeninsula, 0102 0303 0101 0202 0102 0808 0505 0507\nPeninsula, 0202 0303 0101 0202 0102 0808 0505 0505\nPeninsula, 0202 0101 0101 0101 0102 0808 0505 0507\nPeninsula, 0102 0101 0101 0202 0202 0708 0505 0505\nPeninsula, 0102 0104 0101 0102 0102 0808 0505 0505\nPeninsula, 0102 0304 0101 0101 0202 0707 0505 0606\nPeninsula, 0101 0303 0101 0202 0202 0707 0505 0506\nPeninsula, 0101 0303 0101 0101 0202 0707 0505 0606\nPeninsula, 0102 0303 0101 0102 0202 0708 0505 0506\nPeninsula, 0102 0303 0101 0101 0202 0707 0505 0606\nPeninsula, 0202 0303 0101 0202 0202 0708 0505 0506\nPeninsula, 0101 0303 0101 0101 0202 0708 0505 0607\nPeninsula, 0101 0303 0101 0101 0202 0707 0505 0606\nPeninsula, 0102 0303 0101 0101 0202 0909 0505 0506\nPeninsula, 0102 0104 0101 0202 0202 0808 0505 0506\nPeninsula, 0202 0101 0101 0102 0101 0808 0505 0505\nPeninsula, 0202 0104 0101 0101 0102 0708 0505 0505\nPeninsula, 0202 0101 0101 0202 0101 0708 0505 0505\nPeninsula, 0202 0404 0101 0102 0102 0808 0505 0506\nPeninsula, 0102 0103 0101 0202 0102 0808 0505 0505\nPeninsula, 0101 0103 0101 0102 0202 0808 0505 0505\nPeninsula, 0102 0404 0101 0202 0102 0808 0505 0505\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1010\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1011\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1011\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0505 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0808 1011\nPeninsula, 0202 0103 0101 0202 0101 0708 0505 0707\nPeninsula, 0202 0303 0101 0202 0202 0707 0505 0505\nPeninsula, 0202 0103 0101 0202 0202 0709 0505 0505\nPeninsula, 0102 0103 0101 0202 0202 0707 0505 0505\nPeninsula, 0202 0303 0101 0202 0202 0707 0505 0505\nPeninsula, 0102 0103 0101 0202 0202 0707 0505 0507\nPeninsula, 0202 0103 0101 0202 0202 0808 0505 0505\nPeninsula, 0202 0103 0101 0202 0202 0808 0505 0505\nPeninsula, 0202 0103 0101 0202 0202 0708 0505 0508\nPeninsula, 0102 0103 0101 0202 0202 0708 0505 0506\nPeninsula, 0202 0103 0101 0101 0202 0606 0505 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0507 1111\nPeninsula, 0202 0303 0101 0101 0202 0607 0505 1111\nPeninsula, 0202 0303 0101 0101 0202 0607 0505 1011\nPeninsula, 0202 0303 0101 0101 0202 0606 0505 1111\nPeninsula, 0202 0303 0101 0101 0202 0606 0505 1010\nPeninsula, 0102 0000 0000 0102 0000 0000 0202 0000\nPeninsula, 0202 0303 0101 0101 0202 0506 0505 1111\nPeninsula, 0102 0000 0000 0102 0000 0000 0505 0000\nPeninsula, 0202 0303 0101 0101 0202 0606 0505 1011\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\nNA\n\n\n\nst &lt;- to_structure(arapat, stratum = \"Species\")\ncat(st[1:5], sep = \"\\n\")\n\n1 3 01 -9 02 01 -9 -9 09 07\n1 3 01 -9 04 02 -9 -9 09 07\n2 3 01 01 01 01 01 08 09 07\n2 3 01 03 01 01 01 09 09 07\n3 3 01 01 01 01 01 08 09 05\n3 3 01 03 01 01 01 09 09 07\n4 3 01 01 01 01 01 08 09 07\n4 3 01 01 02 01 01 09 09 07\n5 3 01 01 01 01 01 08 09 05\n5 3 01 03 02 01 01 09 09 05\n6 3 01 01 01 01 01 09 09 07\n6 3 01 01 02 01 01 09 09 07\n7 3 01 01 01 01 01 07 09 05\n7 3 01 01 02 01 01 09 09 07\n8 3 01 01 01 01 01 07 09 05\n8 3 01 01 02 01 01 07 09 07\n9 3 01 01 01 01 01 09 09 07\n9 3 01 03 02 01 01 10 09 07\n10 3 01 01 01 01 01 07 09 07\n10 3 01 01 01 01 02 08 09 07\n11 3 01 01 01 01 01 06 09 07\n11 3 01 01 02 01 01 09 09 07\n12 3 01 01 01 01 01 09 09 07\n12 3 01 01 02 01 01 09 09 07\n13 3 01 01 01 01 01 09 09 07\n13 3 01 01 02 01 01 09 09 07\n14 3 01 01 01 01 01 06 09 07\n14 3 01 01 02 01 01 06 09 07\n15 3 01 01 01 01 01 09 07 05\n15 3 01 03 02 01 01 09 09 07\n16 3 01 01 01 01 01 09 09 07\n16 3 01 01 01 01 01 09 09 07\n17 3 01 01 01 01 01 09 05 07\n17 3 01 03 01 01 01 10 09 07\n18 3 01 01 01 01 01 07 09 07\n18 3 01 01 02 01 01 09 09 07\n19 3 01 01 01 01 01 09 09 07\n19 3 01 03 01 01 01 09 09 07\n20 3 01 01 01 01 01 09 09 05\n20 3 01 03 01 01 01 09 09 07\n21 3 01 01 01 01 01 08 09 05\n21 3 01 01 01 01 02 09 09 15\n22 3 01 01 01 01 01 07 07 07\n22 3 01 01 02 01 01 09 09 07\n23 3 01 -9 01 01 -9 -9 05 07\n23 3 01 -9 01 02 -9 -9 09 07\n24 3 01 01 01 01 01 07 09 07\n24 3 01 01 05 01 01 07 09 07\n25 3 01 01 01 01 01 09 09 07\n25 3 01 01 01 01 01 09 09 07\n26 3 01 01 01 01 01 07 09 05\n26 3 01 01 02 01 01 09 09 05\n27 3 01 01 01 01 01 09 09 05\n27 3 01 01 02 01 01 09 09 07\n28 3 01 01 01 01 01 09 07 07\n28 3 01 03 05 01 01 09 09 07\n29 3 01 01 01 01 01 08 09 05\n29 3 01 01 02 01 02 09 09 07\n30 3 01 01 01 01 01 09 09 05\n30 3 01 01 02 01 01 09 09 07\n31 3 01 01 01 01 02 09 09 05\n31 3 01 01 01 01 02 09 09 05\n32 3 01 01 01 01 01 06 09 07\n32 3 01 03 01 01 02 09 09 07\n33 3 01 01 01 01 02 08 09 05\n33 3 01 01 01 01 02 09 09 07\n34 3 01 01 01 01 02 08 09 07\n34 3 01 01 01 01 02 08 09 07\n35 3 01 03 01 01 02 09 09 05\n35 3 01 03 02 01 02 10 09 07\n36 3 01 01 01 01 02 07 09 05\n36 3 01 03 01 01 02 07 09 07\n37 3 01 01 01 01 02 06 09 05\n37 3 01 01 01 01 02 09 09 07\n38 3 01 01 01 01 02 07 09 07\n38 3 01 03 01 01 02 09 09 07\n39 3 01 01 01 01 01 06 09 07\n39 3 01 03 01 01 02 08 09 07\n40 3 01 01 01 01 02 08 09 07\n40 3 01 01 01 01 02 09 09 07\n41 3 01 01 01 01 01 09 09 07\n41 3 01 03 01 01 01 10 09 07\n42 3 01 01 01 01 01 09 09 07\n42 3 01 03 02 01 01 09 09 07\n43 3 01 01 01 01 01 06 09 07\n43 3 01 01 02 01 02 09 09 07\n44 3 01 01 01 01 01 09 09 05\n44 3 01 01 02 01 01 09 09 05\n45 3 01 01 01 01 01 07 09 05\n45 3 01 01 02 01 01 09 09 08\n46 3 01 03 01 01 02 08 07 07\n46 3 01 03 01 01 02 08 10 07\n47 3 01 03 01 01 02 09 09 07\n47 3 01 03 01 01 02 09 09 07\n48 3 01 03 01 01 02 07 09 05\n48 3 01 03 01 01 02 08 09 07\n49 3 01 03 01 01 01 07 09 05\n49 3 02 03 01 01 02 09 09 05\n50 3 01 03 01 01 01 07 09 06\n50 3 01 03 01 01 01 08 09 07\n51 3 01 03 01 01 02 07 07 05\n51 3 01 03 01 01 02 07 09 07\n52 3 01 03 01 01 01 07 07 05\n52 3 02 03 03 01 01 07 09 07\n53 3 01 01 01 01 02 08 09 05\n53 3 01 03 01 01 02 08 09 07\n54 3 01 03 01 01 01 08 09 04\n54 3 01 03 03 01 02 09 09 07\n55 3 01 01 01 01 02 08 09 06\n55 3 01 03 01 01 02 08 09 07\n56 3 01 03 01 01 -9 08 09 05\n56 3 01 03 01 01 -9 09 09 06\n57 3 01 01 01 01 02 07 07 05\n57 3 01 01 02 01 02 09 09 05\n58 3 01 01 01 01 02 08 09 05\n58 3 01 03 01 01 02 08 09 07\n59 3 01 01 01 01 02 07 09 05\n59 3 01 01 01 01 02 07 09 05\n60 3 01 01 01 01 02 09 09 07\n60 3 01 03 01 01 02 09 09 07\n61 3 01 01 03 01 02 08 09 05\n61 3 01 03 03 01 02 08 09 05\n62 3 01 03 01 01 01 07 09 07\n62 3 02 03 01 01 02 08 09 07\n63 3 01 01 01 01 02 08 07 07\n63 3 02 03 01 01 02 08 09 07\n64 3 01 01 01 01 01 08 09 07\n64 3 01 03 01 01 02 09 09 07\n65 3 01 01 01 01 02 08 09 05\n65 3 01 03 01 01 02 08 09 07\n66 3 01 03 01 01 02 07 09 05\n66 3 01 03 03 01 02 09 10 07\n67 3 01 03 01 01 02 09 09 05\n67 3 01 03 01 01 02 09 10 07\n68 3 01 03 03 01 02 08 07 07\n68 3 01 03 03 01 02 09 09 08\n69 3 01 03 01 01 -9 07 09 07\n69 3 02 03 01 01 -9 10 09 07\n70 3 01 03 03 01 02 07 07 05\n70 3 01 03 05 01 02 08 09 07\n71 3 01 03 01 01 02 08 07 05\n71 3 01 03 01 01 02 09 07 07\n72 3 01 03 01 01 02 07 07 05\n72 3 02 03 01 01 02 09 09 07\n73 3 01 03 01 01 02 07 09 05\n73 3 01 03 01 01 02 09 09 07\n74 3 01 03 01 01 02 07 07 05\n74 3 01 03 01 01 02 07 09 07\n75 3 01 01 01 01 02 07 09 07\n75 3 01 03 01 01 02 07 09 07\n76 3 01 01 01 01 02 08 09 05\n76 3 01 03 03 01 02 09 09 07\n77 3 01 01 02 01 02 07 09 04\n77 3 01 03 05 01 02 08 09 07\n78 3 01 01 01 01 02 07 07 05\n78 3 01 03 01 01 02 08 09 07\n79 3 01 01 01 01 02 08 07 05\n79 3 01 03 01 01 02 11 09 07\n80 3 01 01 01 01 02 08 09 04\n80 3 02 03 01 01 02 08 09 07\n81 3 01 03 01 01 02 07 09 05\n81 3 02 03 01 01 02 08 09 07\n82 3 01 03 01 01 02 08 09 05\n82 3 01 03 01 02 02 09 09 07\n83 3 01 03 01 01 02 08 09 05\n83 3 01 03 01 01 02 09 09 07\n84 3 01 03 03 01 02 08 07 05\n84 3 01 03 03 01 02 08 09 07\n85 3 01 03 01 01 02 07 05 05\n85 3 01 03 01 02 02 07 05 07\n86 3 01 03 01 02 02 06 05 05\n86 3 01 03 01 02 02 08 05 07\n87 3 01 03 01 01 02 08 05 07\n87 3 02 03 01 02 02 09 05 07\n88 3 01 03 01 01 01 07 05 06\n88 3 01 03 01 02 02 08 05 07\n89 3 01 03 01 01 02 07 05 05\n89 3 02 03 01 02 02 07 05 05\n90 3 02 03 01 02 02 06 05 07\n90 3 02 03 01 02 02 07 05 07\n91 3 01 01 01 01 02 09 05 05\n91 3 01 03 01 02 02 09 05 07\n92 3 01 01 01 01 02 08 05 07\n92 3 01 03 01 02 02 08 05 08\n93 3 01 03 01 02 02 07 05 07\n93 3 01 03 01 02 02 07 05 07\n94 3 01 03 01 02 01 08 05 06\n94 3 01 03 01 02 01 08 05 07\n95 3 01 03 01 02 02 07 05 05\n95 3 01 03 01 02 02 09 07 06\n96 3 01 03 01 02 02 09 05 05\n96 3 02 03 01 02 02 09 05 05\n97 3 01 03 01 01 02 09 05 05\n97 3 01 03 01 01 02 09 05 07\n98 3 01 01 01 02 02 02 05 04\n98 3 01 03 01 02 02 09 05 08\n99 3 01 03 01 02 02 07 05 05\n99 3 02 03 01 02 02 07 05 05\n100 3 01 01 01 01 02 08 05 05\n100 3 01 04 01 01 02 08 05 06\n101 3 02 03 01 02 01 07 05 07\n101 3 02 03 01 02 02 08 05 08\n102 3 01 01 01 01 02 06 05 05\n102 3 01 01 01 01 02 07 05 05\n103 3 01 03 01 01 01 07 05 07\n103 3 01 03 01 02 01 08 05 07\n104 3 01 01 01 01 -9 07 05 06\n104 3 01 01 01 01 -9 07 05 06\n105 3 01 01 01 01 02 07 05 05\n105 3 01 03 01 01 02 13 05 05\n106 3 01 03 01 01 02 08 05 07\n106 3 01 03 01 02 02 08 05 07\n107 3 01 01 01 02 -9 07 05 06\n107 3 02 01 01 02 -9 08 05 06\n108 3 01 03 01 02 02 07 05 05\n108 3 01 03 03 02 02 08 05 07\n109 3 01 01 01 01 02 08 05 06\n109 3 01 03 01 01 02 08 05 08\n110 3 01 01 01 01 -9 07 05 05\n110 3 01 03 01 02 -9 07 07 06\n111 3 01 03 01 02 01 08 05 05\n111 3 01 03 01 02 02 08 05 07\n112 3 01 01 01 02 02 07 05 05\n112 3 01 01 01 02 02 07 05 07\n113 3 01 01 01 01 02 05 05 05\n113 3 01 03 01 01 02 07 05 06\n114 3 01 01 01 01 01 08 05 05\n114 3 01 03 01 01 02 10 05 05\n115 3 01 01 01 02 02 07 05 05\n115 3 02 03 01 02 02 07 05 07\n116 3 01 01 01 02 02 07 05 05\n116 3 01 03 01 02 02 08 05 08\n117 3 01 03 01 02 01 08 05 04\n117 3 01 03 01 02 02 08 05 06\n118 3 01 03 01 02 01 08 05 05\n118 3 02 03 01 02 02 08 05 07\n119 3 01 01 01 02 02 08 05 07\n119 3 01 03 01 02 02 08 05 07\n120 3 01 01 01 01 02 06 05 05\n120 3 02 03 01 01 02 07 05 05\n121 3 01 03 01 01 01 01 05 07\n121 3 01 03 01 01 02 07 05 08\n122 3 01 01 01 01 02 07 05 05\n122 3 02 03 01 01 02 07 05 06\n123 3 01 03 01 01 02 08 05 05\n123 3 01 03 01 02 02 08 05 05\n124 3 01 03 01 01 02 07 05 05\n124 3 01 03 01 02 02 09 05 07\n125 3 01 01 01 01 02 08 05 04\n125 3 01 03 01 02 02 09 05 06\n126 3 01 03 01 01 02 07 05 06\n126 3 01 03 01 02 02 08 05 07\n127 3 01 03 01 01 -9 07 05 05\n127 3 01 03 01 02 -9 08 05 06\n128 3 01 01 01 02 02 08 05 05\n128 3 01 03 01 02 02 08 05 08\n129 3 01 01 01 01 02 08 05 05\n129 3 01 03 01 02 02 08 05 06\n130 3 01 01 01 01 02 07 05 06\n130 3 01 03 01 02 02 09 05 08\n131 3 01 01 01 02 02 07 05 07\n131 3 02 03 01 02 02 08 05 07\n132 3 01 03 01 02 02 08 05 05\n132 3 01 04 01 02 02 10 05 08\n133 3 01 01 01 01 02 07 05 05\n133 3 01 01 01 02 02 08 05 07\n134 3 01 03 01 01 02 07 05 07\n134 3 02 03 01 01 02 07 05 08\n135 3 01 03 01 01 01 06 05 05\n135 3 02 03 01 01 02 09 05 06\n136 3 01 03 01 01 02 07 05 05\n136 3 01 03 01 02 02 09 05 07\n137 3 01 03 01 02 02 07 05 06\n137 3 02 03 01 02 02 08 05 06\n138 3 01 01 01 01 02 08 05 06\n138 3 01 03 01 02 02 08 05 07\n139 3 01 03 01 01 02 07 05 05\n139 3 02 03 01 02 02 08 05 07\n140 3 01 03 01 01 02 08 05 05\n140 3 01 03 01 02 02 08 05 05\n141 3 01 01 01 02 01 08 05 05\n141 3 01 01 01 02 02 08 05 05\n142 3 01 03 01 01 -9 08 05 07\n142 3 02 03 01 01 -9 09 05 07\n143 3 01 01 01 02 -9 08 05 05\n143 3 02 01 01 02 -9 08 05 05\n144 3 01 03 01 01 02 08 05 06\n144 3 01 03 01 02 02 08 05 06\n145 3 01 01 01 01 01 07 05 07\n145 3 02 03 01 01 02 10 05 07\n146 3 01 01 01 02 02 07 05 05\n146 3 01 01 04 02 02 08 05 07\n147 3 01 01 01 02 01 07 05 06\n147 3 01 04 04 02 01 08 05 07\n148 3 01 01 01 01 02 07 05 05\n148 3 02 01 01 01 02 08 05 07\n149 3 01 01 01 02 01 07 05 05\n149 3 02 01 01 02 02 07 05 06\n150 3 02 01 01 02 02 08 05 05\n150 3 02 04 01 02 02 08 05 08\n151 3 01 03 01 01 02 07 05 05\n151 3 02 04 01 02 02 10 05 05\n152 3 01 01 01 02 01 08 05 05\n152 3 01 03 01 02 02 08 05 06\n153 3 01 03 01 02 02 07 05 05\n153 3 01 03 01 02 02 09 05 06\n154 3 01 01 01 02 02 07 05 05\n154 3 01 04 01 02 02 07 05 05\n155 3 01 03 01 01 01 07 05 05\n155 3 02 03 01 02 02 07 05 05\n156 3 01 03 01 02 02 07 05 05\n156 3 02 03 01 02 02 08 05 07\n157 3 01 03 01 02 01 07 05 05\n157 3 01 04 01 02 02 08 05 06\n158 3 01 01 01 01 02 07 05 05\n158 3 01 03 01 02 02 09 05 05\n159 3 01 03 01 01 01 08 05 05\n159 3 02 04 01 01 02 08 05 07\n160 3 01 03 01 01 01 08 05 05\n160 3 01 03 01 02 02 09 05 07\n161 3 01 01 01 01 01 07 05 07\n161 3 02 03 01 02 02 07 05 07\n162 3 01 01 01 01 02 07 05 05\n162 3 02 03 01 02 02 08 05 08\n163 3 02 01 01 02 02 08 05 05\n163 3 02 01 01 02 02 09 05 07\n164 3 02 03 01 02 02 07 05 05\n164 3 02 03 01 02 02 07 05 07\n165 3 02 01 01 02 01 09 05 05\n165 3 02 03 01 02 02 09 05 07\n166 3 01 01 01 02 01 08 05 05\n166 3 02 03 01 02 02 08 05 05\n167 3 01 03 01 02 02 07 05 05\n167 3 02 03 01 02 02 07 05 07\n168 3 01 03 01 02 01 08 05 05\n168 3 02 03 01 02 02 08 05 07\n169 3 02 01 01 02 01 08 05 05\n169 3 02 01 01 02 02 09 05 05\n170 3 02 03 01 02 02 07 05 05\n170 3 02 03 01 02 02 07 05 08\n171 3 01 03 01 02 02 07 05 05\n171 3 02 03 01 02 02 07 05 05\n172 3 02 03 01 02 02 07 05 05\n172 3 02 03 01 02 02 08 05 07\n173 3 02 01 01 01 02 07 05 05\n173 3 02 03 01 01 02 09 05 05\n174 1 01 02 01 01 02 03 03 18\n174 1 01 02 02 01 02 04 03 18\n175 3 01 03 01 02 02 05 05 05\n175 3 01 03 01 02 02 09 05 08\n176 3 01 01 01 02 02 07 05 06\n176 3 01 03 01 02 02 08 05 06\n177 3 01 01 01 02 01 08 05 05\n177 3 01 03 01 02 01 08 05 05\n178 1 02 02 02 01 02 04 03 18\n178 1 02 02 02 01 02 04 03 18\n179 3 01 03 01 02 02 07 05 05\n179 3 02 03 01 02 02 08 05 08\n180 3 01 03 01 02 02 07 05 05\n180 3 02 03 01 02 02 08 05 07\n181 3 01 03 01 02 02 05 05 05\n181 3 01 03 01 02 02 05 05 07\n182 3 01 03 01 02 01 07 05 05\n182 3 01 03 01 02 02 07 05 05\n183 3 01 03 01 02 01 07 05 07\n183 3 02 03 01 02 02 07 05 07\n184 3 01 01 01 02 01 07 05 07\n184 3 01 03 01 02 02 07 05 07\n185 3 01 01 01 02 01 06 05 07\n185 3 01 03 01 02 01 06 05 07\n186 3 01 01 01 02 01 06 05 07\n186 3 01 03 01 02 02 08 05 07\n187 3 02 01 01 02 01 07 05 07\n187 3 02 03 01 02 01 07 05 07\n188 3 01 03 01 02 01 07 05 05\n188 3 01 03 01 02 01 08 05 07\n189 3 01 01 01 02 01 07 05 06\n189 3 01 03 01 02 01 09 05 07\n190 3 01 03 01 02 01 07 05 06\n190 3 02 03 04 02 01 07 05 06\n191 3 01 03 01 02 01 07 05 07\n191 3 02 03 04 02 02 08 05 07\n192 3 01 03 01 02 01 07 05 06\n192 3 02 03 01 02 02 09 05 07\n193 3 01 03 01 02 01 08 05 05\n193 3 01 03 01 02 01 08 05 06\n194 3 01 03 01 02 01 08 05 05\n194 3 01 04 01 02 01 08 05 07\n195 3 01 03 01 02 01 07 05 07\n195 3 01 04 01 02 02 09 05 07\n196 3 01 01 01 02 02 08 05 05\n196 3 02 03 01 02 02 08 05 05\n197 3 01 01 01 02 01 07 05 06\n197 3 02 03 01 02 02 07 05 06\n198 3 02 03 01 02 01 08 05 05\n198 3 02 05 01 02 02 08 05 05\n199 3 02 03 01 02 02 06 05 05\n199 3 02 05 01 02 02 07 05 07\n200 3 02 03 01 02 01 08 05 05\n200 3 02 04 01 02 02 08 05 06\n201 3 01 03 01 02 01 07 05 05\n201 3 02 03 01 02 02 08 05 05\n202 3 02 03 01 02 01 07 05 05\n202 3 02 03 01 02 02 07 05 05\n203 3 01 03 01 02 01 08 05 05\n203 3 02 03 01 02 02 08 05 07\n204 3 02 03 01 02 01 08 05 05\n204 3 02 03 01 02 02 08 05 05\n205 1 01 02 02 01 02 04 03 18\n205 1 02 02 02 01 02 04 03 18\n206 1 02 02 01 01 02 03 03 19\n206 1 02 02 01 01 02 03 03 19\n207 1 02 02 01 01 02 04 03 18\n207 1 02 02 01 01 02 04 03 18\n208 3 02 01 01 01 01 08 05 05\n208 3 02 01 01 01 02 08 05 07\n209 1 01 01 01 01 -9 -9 09 18\n209 1 02 01 01 02 -9 -9 09 18\n210 1 02 02 02 01 02 04 03 18\n210 1 02 02 02 01 02 04 03 19\n211 1 02 02 01 01 02 03 03 18\n211 1 02 02 02 01 02 04 03 18\n212 3 01 01 01 02 02 07 05 05\n212 3 02 01 01 02 02 08 05 05\n213 1 02 02 02 01 02 03 03 18\n213 1 02 02 02 01 02 03 03 18\n214 1 02 02 02 01 02 03 03 18\n214 1 02 02 02 01 02 04 03 18\n215 3 01 01 01 01 01 08 05 05\n215 3 02 04 01 02 02 08 05 05\n216 3 01 03 01 01 02 07 05 06\n216 3 02 04 01 01 02 07 05 06\n217 3 01 03 01 02 02 07 05 05\n217 3 01 03 01 02 02 07 05 06\n218 3 01 03 01 01 02 07 05 06\n218 3 01 03 01 01 02 07 05 06\n219 1 02 02 01 01 02 04 03 18\n219 1 02 02 01 01 02 04 03 18\n220 3 01 03 01 01 02 07 05 05\n220 3 02 03 01 02 02 08 05 06\n221 3 01 03 01 01 02 07 05 06\n221 3 02 03 01 01 02 07 05 06\n222 3 02 03 01 02 02 07 05 05\n222 3 02 03 01 02 02 08 05 06\n223 3 01 03 01 01 02 07 05 06\n223 3 01 03 01 01 02 08 05 07\n224 3 01 03 01 01 02 07 05 06\n224 3 01 03 01 01 02 07 05 06\n225 3 01 03 01 01 02 09 05 05\n225 3 02 03 01 01 02 09 05 06\n226 1 01 01 01 01 02 03 03 18\n226 1 01 02 02 01 02 04 03 18\n227 3 01 01 01 02 02 08 05 05\n227 3 02 04 01 02 02 08 05 06\n228 1 02 02 02 01 02 03 03 18\n228 1 02 02 02 01 02 05 03 18\n229 3 02 01 01 01 01 08 05 05\n229 3 02 01 01 02 01 08 05 05\n230 3 02 01 01 01 01 07 05 05\n230 3 02 04 01 01 02 08 05 05\n231 3 02 01 01 02 01 07 05 05\n231 3 02 01 01 02 01 08 05 05\n232 3 02 04 01 01 01 08 05 05\n232 3 02 04 01 02 02 08 05 06\n233 3 01 01 01 02 01 08 05 05\n233 3 02 03 01 02 02 08 05 05\n234 3 01 01 01 01 02 08 05 05\n234 3 01 03 01 02 02 08 05 05\n235 3 01 04 01 02 01 08 05 05\n235 3 02 04 01 02 02 08 05 05\n236 1 02 02 01 01 02 05 03 18\n236 1 02 02 01 01 02 05 03 19\n237 1 01 -9 01 02 -9 -9 03 18\n237 1 02 -9 01 02 -9 -9 03 18\n238 1 02 02 01 01 -9 -9 02 18\n238 1 02 02 02 02 -9 -9 02 18\n239 1 02 02 01 01 02 04 03 18\n239 1 02 02 02 01 02 04 03 18\n240 1 02 02 01 01 02 05 03 17\n240 1 02 02 02 01 02 05 03 18\n241 1 02 02 01 01 02 05 03 17\n241 1 02 02 02 01 02 05 03 17\n242 1 01 02 01 01 -9 -9 03 17\n242 1 02 02 01 02 -9 -9 03 18\n243 1 02 02 01 01 02 04 03 17\n243 1 02 02 02 01 02 04 03 17\n244 1 02 02 01 01 02 05 03 18\n244 1 02 02 02 01 02 05 03 18\n245 3 02 03 01 01 02 06 08 10\n245 3 02 03 01 01 02 06 08 10\n246 1 02 02 01 01 02 04 03 18\n246 1 02 02 02 01 02 04 03 18\n247 1 02 02 02 01 02 03 03 18\n247 1 02 02 02 01 02 05 03 18\n248 3 02 03 01 01 02 06 08 10\n248 3 02 03 01 01 02 06 08 11\n249 3 02 03 01 01 02 06 08 11\n249 3 02 03 01 01 02 06 08 11\n250 3 02 03 01 01 02 06 08 11\n250 3 02 03 01 01 02 06 08 11\n251 3 02 03 01 01 02 06 08 11\n251 3 02 03 01 01 02 06 08 11\n252 1 01 02 02 01 02 03 03 18\n252 1 02 02 02 01 02 05 03 18\n253 3 02 03 01 01 02 06 08 11\n253 3 02 03 01 01 02 06 08 11\n254 3 02 03 01 01 02 06 08 10\n254 3 02 03 01 01 02 06 08 11\n255 1 01 02 02 01 02 03 03 18\n255 1 02 02 02 01 02 03 03 18\n256 3 02 03 01 01 02 06 08 11\n256 3 02 03 01 01 02 06 08 11\n257 3 02 03 01 01 02 06 05 11\n257 3 02 03 01 01 02 06 05 11\n258 1 02 02 02 01 02 04 03 18\n258 1 02 02 02 01 02 04 03 18\n259 1 02 02 02 01 02 05 03 18\n259 1 02 02 02 01 02 05 03 18\n260 3 02 03 01 01 02 06 08 10\n260 3 02 03 01 01 02 06 08 11\n261 1 02 02 02 01 02 04 03 18\n261 1 02 02 02 01 02 04 03 18\n262 1 02 02 01 01 02 04 03 18\n262 1 02 02 02 01 02 04 03 18\n263 1 02 01 01 01 02 04 03 18\n263 1 02 02 02 01 02 04 03 18\n264 1 02 01 01 01 02 04 03 17\n264 1 02 02 02 01 02 04 03 17\n265 3 02 01 01 02 01 07 05 07\n265 3 02 03 01 02 01 08 05 07\n266 3 02 03 01 02 02 07 05 05\n266 3 02 03 01 02 02 07 05 05\n267 3 02 01 01 02 02 07 05 05\n267 3 02 03 01 02 02 09 05 05\n268 3 01 01 01 02 02 07 05 05\n268 3 02 03 01 02 02 07 05 05\n269 3 02 03 01 02 02 07 05 05\n269 3 02 03 01 02 02 07 05 05\n270 3 01 01 01 02 02 07 05 05\n270 3 02 03 01 02 02 07 05 07\n271 3 02 01 01 02 02 08 05 05\n271 3 02 03 01 02 02 08 05 05\n272 3 02 01 01 02 02 08 05 05\n272 3 02 03 01 02 02 08 05 05\n273 3 02 01 01 02 02 07 05 05\n273 3 02 03 01 02 02 08 05 08\n274 3 01 01 01 02 02 07 05 05\n274 3 02 03 01 02 02 08 05 06\n275 1 02 02 02 01 02 04 03 18\n275 1 02 02 02 01 02 04 03 18\n276 1 02 02 02 01 02 04 01 17\n276 1 02 02 02 01 02 04 01 17\n277 1 02 02 02 01 02 04 03 18\n277 1 02 02 02 01 02 04 03 18\n278 1 02 02 02 01 02 04 03 18\n278 1 02 02 02 01 02 04 03 18\n279 1 02 02 02 01 02 04 03 18\n279 1 02 02 02 01 02 04 03 18\n280 1 02 02 02 01 02 04 03 18\n280 1 02 02 02 01 02 04 03 18\n281 1 02 02 02 01 02 04 03 17\n281 1 02 02 02 01 02 04 03 18\n282 1 02 02 02 01 02 04 03 17\n282 1 02 02 02 01 02 04 03 17\n283 1 02 02 02 01 02 05 03 18\n283 1 02 02 02 01 02 05 03 18\n284 1 02 02 02 01 02 04 03 18\n284 1 02 02 02 01 02 04 03 18\n285 1 02 02 02 01 02 05 03 18\n285 1 02 02 02 01 02 05 03 18\n286 1 02 02 01 01 02 04 03 17\n286 1 02 02 02 01 02 04 03 17\n287 1 02 02 01 01 02 04 03 18\n287 1 02 02 02 01 02 04 06 18\n288 1 02 02 02 01 02 04 03 18\n288 1 02 02 02 01 02 04 03 18\n289 1 02 01 02 01 02 04 03 16\n289 1 02 01 02 01 02 04 03 17\n290 1 02 02 02 01 02 05 03 17\n290 1 02 02 02 01 02 05 03 18\n291 1 02 02 02 01 02 05 03 17\n291 1 02 02 02 01 02 05 03 18\n292 1 02 02 01 01 02 04 03 17\n292 1 02 02 02 01 02 04 03 18\n293 3 02 01 01 01 02 06 05 11\n293 3 02 03 01 01 02 06 05 11\n294 1 02 02 01 01 02 04 03 17\n294 1 02 02 02 01 02 04 06 17\n295 1 02 02 01 01 02 04 03 18\n295 1 02 02 02 01 02 04 06 18\n296 3 02 03 01 01 02 06 05 11\n296 3 02 03 01 01 02 06 07 11\n297 1 02 02 01 01 02 04 03 18\n297 1 02 02 02 01 02 04 03 18\n298 1 02 02 01 01 02 04 03 18\n298 1 02 02 02 01 02 04 03 18\n299 1 02 02 02 01 02 04 03 17\n299 1 02 02 02 01 02 04 03 18\n300 1 02 02 02 01 02 04 03 17\n300 1 02 02 02 01 02 04 03 17\n301 3 02 03 01 01 02 06 05 11\n301 3 02 03 01 01 02 07 05 11\n302 1 02 02 01 01 02 04 03 18\n302 1 02 02 02 01 02 04 03 18\n303 1 02 02 01 01 02 05 03 18\n303 1 02 02 02 01 02 05 03 19\n304 1 02 02 01 01 02 05 03 17\n304 1 02 02 02 01 02 05 03 17\n305 1 02 02 01 01 -9 05 03 18\n305 1 02 02 02 01 -9 05 03 18\n306 3 02 03 01 01 02 06 05 10\n306 3 02 03 01 01 02 07 05 11\n307 1 02 02 01 01 02 04 03 18\n307 1 02 02 02 01 02 04 03 18\n308 1 02 02 01 01 02 04 03 18\n308 1 02 02 02 01 02 04 03 18\n309 1 02 02 01 01 02 05 03 18\n309 1 02 02 02 01 02 05 03 18\n310 1 02 02 01 01 02 05 03 18\n310 1 02 02 02 01 02 05 03 18\n311 1 01 02 01 01 02 05 03 18\n311 1 02 02 02 01 02 05 03 18\n312 3 02 03 01 01 02 06 05 11\n312 3 02 03 01 01 02 06 05 11\n313 3 02 03 01 01 02 06 05 10\n313 3 02 03 01 01 02 06 05 10\n314 1 01 02 01 01 02 04 03 18\n314 1 02 02 01 01 02 04 03 19\n315 1 02 02 02 01 02 04 03 18\n315 1 02 02 02 01 02 04 03 18\n316 3 01 -9 -9 01 -9 -9 02 -9\n316 3 02 -9 -9 02 -9 -9 02 -9\n317 1 02 02 02 01 02 04 03 18\n317 1 02 02 02 01 02 04 03 18\n318 3 02 03 01 01 02 05 05 11\n318 3 02 03 01 01 02 06 05 11\n319 1 02 01 02 01 02 04 03 18\n319 1 02 01 02 01 02 04 03 18\n320 1 02 01 02 01 02 04 03 18\n320 1 02 02 02 01 02 04 03 18\n321 1 02 01 02 01 02 05 03 17\n321 1 02 01 02 01 02 05 03 18\n322 1 02 01 02 01 02 05 03 18\n322 1 02 01 02 01 02 05 03 18\n323 3 01 -9 -9 01 -9 -9 05 -9\n323 3 02 -9 -9 02 -9 -9 05 -9\n324 3 02 03 01 01 02 06 05 10\n324 3 02 03 01 01 02 06 05 11\n325 1 02 01 02 01 02 05 03 18\n325 1 02 01 02 01 02 05 03 18\n326 1 02 01 02 01 02 05 03 18\n326 1 02 01 02 01 02 05 03 18\n327 1 02 01 02 01 02 05 03 18\n327 1 02 01 02 01 02 05 03 18\n328 2 01 -9 01 -9 -9 -9 02 -9\n328 2 02 -9 01 -9 -9 -9 02 -9\n329 2 02 01 01 01 -9 -9 02 13\n329 2 02 01 01 01 -9 -9 02 13\n330 2 01 -9 01 01 -9 -9 09 -9\n330 2 02 -9 01 02 -9 -9 09 -9\n331 2 02 01 03 01 01 11 02 13\n331 2 02 01 03 02 01 11 02 14\n332 2 01 01 01 01 -9 08 04 12\n332 2 02 01 01 02 -9 08 04 12\n333 2 01 01 03 01 -9 -9 02 12\n333 2 02 01 03 02 -9 -9 02 12\n334 2 02 01 03 01 -9 -9 02 02\n334 2 02 01 03 01 -9 -9 02 12\n335 2 01 -9 01 -9 -9 -9 02 -9\n335 2 02 -9 01 -9 -9 -9 09 -9\n336 2 02 01 01 01 -9 -9 02 11\n336 2 02 01 03 01 -9 -9 09 12\n337 2 01 01 01 01 02 -9 02 12\n337 2 02 03 01 02 02 -9 02 13\n338 2 02 01 03 01 02 11 02 13\n338 2 02 01 03 01 02 11 04 13\n339 2 02 01 03 01 02 11 02 03\n339 2 02 01 04 01 02 11 02 12\n340 2 01 01 03 01 02 11 02 03\n340 2 02 01 03 01 02 11 02 13\n341 2 02 01 03 01 02 11 02 12\n341 2 02 01 03 01 02 11 02 12\n342 2 02 01 03 01 02 11 02 12\n342 2 02 01 03 01 02 11 02 13\n343 2 01 01 03 01 02 11 02 02\n343 2 02 01 03 01 02 11 02 14\n344 2 02 01 03 01 02 12 02 12\n344 2 02 01 03 01 02 12 03 12\n345 2 02 01 03 01 02 12 02 13\n345 2 02 01 03 01 02 12 02 13\n346 2 02 01 03 01 02 11 02 02\n346 2 02 01 03 01 02 11 02 10\n347 2 01 01 03 01 02 12 02 11\n347 2 01 01 04 01 02 12 02 13\n348 2 01 01 03 01 02 08 02 01\n348 2 02 01 04 01 02 12 04 12\n349 2 01 01 04 01 02 11 02 03\n349 2 02 01 04 01 02 11 02 13\n350 2 02 01 03 01 02 10 02 11\n350 2 02 01 04 01 02 11 02 11\n351 2 01 01 03 01 02 12 02 10\n351 2 02 01 03 01 02 12 02 13\n352 2 02 01 03 01 02 12 02 02\n352 2 02 01 03 01 02 12 02 10\n353 2 01 01 03 01 02 08 02 02\n353 2 02 01 04 01 02 11 02 14\n354 2 02 01 03 01 02 11 02 03\n354 2 02 01 03 01 02 11 02 13\n355 2 02 01 03 01 02 11 02 11\n355 2 02 01 04 01 02 11 02 12\n356 2 02 -9 01 01 -9 -9 02 09\n356 2 02 -9 03 02 -9 -9 09 09\n357 2 01 01 03 01 -9 -9 02 03\n357 2 02 01 03 02 -9 -9 02 12\n358 2 01 -9 -9 01 -9 -9 02 02\n358 2 02 -9 -9 02 -9 -9 02 05\n359 2 01 01 03 01 -9 -9 02 11\n359 2 02 01 03 01 -9 -9 02 12\n360 2 01 -9 03 01 -9 11 02 11\n360 2 02 -9 03 02 -9 11 02 13\n361 2 02 01 01 01 -9 -9 02 12\n361 2 02 01 01 01 -9 -9 02 12\n362 2 01 01 03 01 -9 -9 02 12\n362 2 02 01 03 02 -9 -9 02 12\n363 2 02 01 03 01 -9 -9 02 03\n363 2 02 01 03 02 -9 -9 02 13\nNA\nNA\nNA\nNA",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Importing & Exporting Data</span>"
    ]
  },
  {
    "objectID": "data-io.html#generating-synthetic-data",
    "href": "data-io.html#generating-synthetic-data",
    "title": "3  Importing & Exporting Data",
    "section": "3.4 Generating Synthetic Data",
    "text": "3.4 Generating Synthetic Data\n\n3.4.1 From Allele Frequencies\nThe make_population() function creates a random population from a frequency table:\n\nfreqs &lt;- data.frame(\n  Locus = rep(c(\"TPI\", \"PGM\"), each = 3),\n  Allele = c(\"A\", \"B\", \"C\", \"H\", \"I\", \"J\"),\n  Frequency = c(0.55, 0.30, 0.15, 0.34, 0.34, 0.32)\n)\npop &lt;- make_population(freqs, N = 10)\nhead(pop)\n\n  ID PGM TPI\n1  1 I:J A:C\n2  2 J:J B:B\n3  3 H:J A:B\n4  4 H:I A:B\n5  5 I:I B:C\n6  6 I:I A:A\n\n\n\n\n3.4.2 Multiple Populations\nThe make_populations() function creates several populations at once from a frequency data.frame with a Population column:\n\nlibrary(dplyr, warn.conflicts = FALSE)\nf1 &lt;- data.frame(\n  Population = \"A\",\n  Locus = rep(c(\"Loc1\", \"Loc2\"), each = 2),\n  Allele = rep(c(\"01\", \"02\"), times = 2),\n  Frequency = c(0.2, 0.8, 0.3, 0.7)\n)\nf2 &lt;- data.frame(\n  Population = \"B\",\n  Locus = rep(c(\"Loc1\", \"Loc2\"), each = 2),\n  Allele = rep(c(\"01\", \"02\"), times = 2),\n  Frequency = c(0.7, 0.3, 0.5, 0.5)\n)\nfreqs &lt;- rbind(f1, f2)\nfreqs$Population &lt;- factor(freqs$Population, ordered = TRUE)\npops &lt;- make_populations(freqs, N = 15)\nhead(pops)\n\n  Population ID  Loc1  Loc2\n1          A  1 02:02 01:02\n2          A  2 01:02 01:02\n3          A  3 02:02 02:02\n4          A  4 01:02 01:02\n5          A  5 02:02 02:02\n6          A  6 02:02 02:02\n\ntable(pops$Population)\n\n\n A  B \n15 15 \n\n\n\n\n3.4.3 From Individual Loci\nThe make_loci() function generates a vector of random locus objects:\n\nf &lt;- data.frame(Allele = c(\"A\", \"B\"), Frequency = c(0.6, 0.4))\nloci &lt;- make_loci(f, N = 10)\nloci\n\n [1] \"A:A\" \"B:B\" \"A:B\" \"A:A\" \"A:B\" \"A:B\" \"A:B\" \"A:A\" \"A:A\" \"A:B\"",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Importing & Exporting Data</span>"
    ]
  },
  {
    "objectID": "allele-frequencies.html",
    "href": "allele-frequencies.html",
    "title": "4  Allele Frequencies & HWE",
    "section": "",
    "text": "4.1 Allele Frequencies\nThis chapter covers estimating allele and genotype frequencies, testing for Hardy-Weinberg Equilibrium, and rarefaction analysis.\nThe frequencies() function is an S3 generic that works on both individual locus vectors and entire data.frames.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Allele Frequencies & HWE</span>"
    ]
  },
  {
    "objectID": "allele-frequencies.html#allele-frequencies",
    "href": "allele-frequencies.html#allele-frequencies",
    "title": "4  Allele Frequencies & HWE",
    "section": "",
    "text": "4.1.1 Single Locus\n\nfrequencies(arapat$LTRS)\n\n  Allele Frequency\n1     01  0.523416\n2     02  0.476584\n\n\n\n\n4.1.2 Entire Data Frame\nWhen applied to a data.frame, frequencies() returns frequencies for all locus columns:\n\nfreqs &lt;- frequencies(arapat)\nhead(freqs, 12)\n\n   Locus Allele   Frequency\n1   LTRS     01 0.523415978\n2   LTRS     02 0.476584022\n3    WNT     01 0.357954545\n4    WNT     02 0.181818182\n5    WNT     03 0.430397727\n6    WNT     04 0.026988636\n7    WNT     05 0.002840909\n8     EN     01 0.715277778\n9     EN     02 0.180555556\n10    EN     03 0.080555556\n11    EN     04 0.018055556\n12    EN     05 0.005555556\n\n\n\n\n4.1.3 By Stratum\nAdd a stratum argument to partition frequencies by population:\n\nfreqs_pop &lt;- frequencies(arapat, stratum = \"Species\")\nhead(freqs_pop, 12)\n\n   Stratum Locus Allele  Frequency\n1     Cape  LTRS     01 0.08000000\n2     Cape  LTRS     02 0.92000000\n3     Cape   WNT     01 0.13513514\n4     Cape   WNT     02 0.86486486\n5     Cape    EN     01 0.30000000\n6     Cape    EN     02 0.70000000\n7     Cape    EF     01 0.96666667\n8     Cape    EF     02 0.03333333\n9     Cape   ZMP     02 1.00000000\n10    Cape   AML     03 0.09154930\n11    Cape   AML     04 0.60563380\n12    Cape   AML     05 0.30281690\n\n\n\n\n4.1.4 Selecting Specific Loci\n\nfreqs_sub &lt;- frequencies(arapat, loci = c(\"LTRS\", \"WNT\"))\nfreqs_sub\n\n  Locus Allele   Frequency\n1  LTRS     01 0.523415978\n2  LTRS     02 0.476584022\n3   WNT     01 0.357954545\n4   WNT     02 0.181818182\n5   WNT     03 0.430397727\n6   WNT     04 0.026988636\n7   WNT     05 0.002840909",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Allele Frequencies & HWE</span>"
    ]
  },
  {
    "objectID": "allele-frequencies.html#frequency-matrix",
    "href": "allele-frequencies.html#frequency-matrix",
    "title": "4  Allele Frequencies & HWE",
    "section": "4.2 Frequency Matrix",
    "text": "4.2 Frequency Matrix\nThe frequency_matrix() function produces a wide-format matrix of allele frequencies:\n\nfm &lt;- frequency_matrix(arapat, stratum = \"Species\")\nfm[, 1:8]\n\n    Stratum      AML-01      AML-02    AML-03    AML-04     AML-05     AML-06\n1      Cape 0.000000000 0.000000000 0.0915493 0.6056338 0.30281690 0.00000000\n2  Mainland 0.000000000 0.000000000 0.0000000 0.0000000 0.00000000 0.00000000\n3 Peninsula 0.002016129 0.002016129 0.0000000 0.0000000 0.01008065 0.09879032\n     AML-07\n1 0.0000000\n2 0.0000000\n3 0.3225806",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Allele Frequencies & HWE</span>"
    ]
  },
  {
    "objectID": "allele-frequencies.html#genotype-counts-and-frequencies",
    "href": "allele-frequencies.html#genotype-counts-and-frequencies",
    "title": "4  Allele Frequencies & HWE",
    "section": "4.3 Genotype Counts and Frequencies",
    "text": "4.3 Genotype Counts and Frequencies\n\n4.3.1 Genotype Counts per Stratum\nThe genotype_counts() function summarizes non-missing genotype counts per locus, optionally by stratum:\n\ngenotype_counts(arapat)\n\n    Stratum   N LTRS WNT  EN  EF ZMP AML ATPS MP20\nALL     ALL 363  363 352 360 361 330 340  363  358\n\n\n\ngenotype_counts(arapat, stratum = \"Species\")\n\n            Stratum   N LTRS WNT  EN  EF ZMP AML ATPS MP20\nCape           Cape  75   75  74  75  75  70  71   75   75\nMainland   Mainland  36   36  30  35  34  20  21   36   33\nPeninsula Peninsula 252  252 248 250 252 240 248  252  250\n\n\n\n\n4.3.2 Genotype Frequencies\nThe genotype_frequencies() function returns observed and expected genotype counts for a locus vector:\n\ngenotype_frequencies(arapat$LTRS)\n\n  Genotype Observed  Expected\n1    01:01      147  99.44904\n2    01:02       86 181.10193\n3    02:02      130  82.44904",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Allele Frequencies & HWE</span>"
    ]
  },
  {
    "objectID": "allele-frequencies.html#hardy-weinberg-equilibrium",
    "href": "allele-frequencies.html#hardy-weinberg-equilibrium",
    "title": "4  Allele Frequencies & HWE",
    "section": "4.4 Hardy-Weinberg Equilibrium",
    "text": "4.4 Hardy-Weinberg Equilibrium\nThe hwe() function tests for HWE using a chi-square approximation:\n\nmainland &lt;- arapat[arapat$Species == \"Mainland\", ]\nhwe(mainland)\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for LTRS this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at LTRS consider\ncollapsing alleles.\n\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for WNT this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at WNT consider\ncollapsing alleles.\n\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for EN this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at EN consider\ncollapsing alleles.\n\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for EF this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at EF consider\ncollapsing alleles.\n\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for ZMP this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at ZMP consider\ncollapsing alleles.\n\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for AML this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at AML consider\ncollapsing alleles.\n\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for ATPS this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at ATPS consider\ncollapsing alleles.\n\n\nWarning in genotype_frequencies(x[[locus]]): Some genotype expectations are &lt;\n5, a continuity correction should be applied.  See ?hwe\n\n\nWarning in hwe(mainland): Under 50 samples for MP20 this may not be a good\napproximation.\n\n\nWarning in hwe(mainland): Fewer than 5 genotypes expected at MP20 consider\ncollapsing alleles.\n\n\n  Locus         Chi df         Prob\n1  LTRS   0.9082806  1 3.405710e-01\n2   WNT  29.2542373  1 6.347726e-08\n3    EN  19.7817078  3 1.883729e-04\n4    EF   0.3545808  1 5.515314e-01\n5   ZMP   5.0927978  1 2.402540e-02\n6   AML  36.8802692  6 1.858093e-06\n7  ATPS  43.9698647  6 7.494505e-08\n8  MP20 161.5565210 45 4.773959e-15\n\n\nThe output includes the chi-square statistic, degrees of freedom, and p-value for each locus. Significant p-values indicate departures from HWE expectations.\n\n4.4.1 Interpreting Results\nDepartures from HWE can arise from:\n\nNon-random mating (inbreeding, assortative mating)\nPopulation substructure (Wahlund effect)\nSelection at or near the marker locus\nSmall population size (genetic drift)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Allele Frequencies & HWE</span>"
    ]
  },
  {
    "objectID": "allele-frequencies.html#rarefaction",
    "href": "allele-frequencies.html#rarefaction",
    "title": "4  Allele Frequencies & HWE",
    "section": "4.5 Rarefaction",
    "text": "4.5 Rarefaction\nThe rarefaction() function subsamples the data repeatedly at a smaller sample size to estimate the distribution of a diversity statistic:\n\nrare_vals &lt;- rarefaction(arapat$LTRS, mode = \"Ae\",\n                         size = 20, nperm = 199)\nhist(rare_vals, main = \"Rarefied Ae at LTRS\",\n     xlab = \"Effective Alleles\", col = \"steelblue\")\n\n\n\n\n\n\n\n\nThis is useful for comparing diversity across populations with unequal sample sizes.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Allele Frequencies & HWE</span>"
    ]
  },
  {
    "objectID": "allele-frequencies.html#optimal-sampling",
    "href": "allele-frequencies.html#optimal-sampling",
    "title": "4  Allele Frequencies & HWE",
    "section": "4.6 Optimal Sampling",
    "text": "4.6 Optimal Sampling\nThe optimal_sampling() function estimates how many individuals are needed to capture a given proportion of allelic diversity:\n\noptimal_sampling(arapat$LTRS, nrep = 99)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Allele Frequencies & HWE</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html",
    "href": "genetic-diversity.html",
    "title": "5  Genetic Diversity",
    "section": "",
    "text": "5.1 The genetic_diversity() Wrapper\nThis chapter covers estimation of genetic diversity statistics using the genetic_diversity() wrapper and its underlying per-locus functions.\nThe genetic_diversity() function is the main entry point for diversity estimation. It dispatches to specific estimators based on the mode parameter:",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#the-genetic_diversity-wrapper",
    "href": "genetic-diversity.html#the-genetic_diversity-wrapper",
    "title": "5  Genetic Diversity",
    "section": "",
    "text": "Mode\nStatistic\nDescription\n\n\n\n\n\"A\"\nAllelic richness\nNumber of alleles\n\n\n\"Ae\"\nEffective alleles\n\\(1 / \\sum p_i^2\\)\n\n\n\"A95\"\nA (5% threshold)\nAlleles with frequency &gt;= 0.05\n\n\n\"He\"\nExpected heterozygosity\n\\(1 - \\sum p_i^2\\)\n\n\n\"Ho\"\nObserved heterozygosity\nProportion of heterozygotes\n\n\n\"Hes\"\nCorrected He\nNei’s small-sample corrected He\n\n\n\"Hos\"\nCorrected Ho\nNei’s small-sample corrected Ho\n\n\n\"Fis\"\nInbreeding coefficient\n\\(1 - H_o/H_e\\)\n\n\n\"Pe\"\nPolymorphic index\nWhether the locus is polymorphic",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#global-unstratified-estimates",
    "href": "genetic-diversity.html#global-unstratified-estimates",
    "title": "5  Genetic Diversity",
    "section": "5.2 Global (Unstratified) Estimates",
    "text": "5.2 Global (Unstratified) Estimates\nWithout a stratum, diversity is estimated across all individuals:\n\ngenetic_diversity(arapat, mode = \"A\")\n\n  Locus  A\n1  LTRS  2\n2   WNT  5\n3    EN  5\n4    EF  2\n5   ZMP  2\n6   AML 13\n7  ATPS 10\n8  MP20 19\n\ngenetic_diversity(arapat, mode = \"Ae\")\n\n  Locus       Ae\n1  LTRS 1.995623\n2   WNT 2.880450\n3    EN 1.814656\n4    EF 1.773533\n5   ZMP 1.513877\n6   AML 5.860583\n7  ATPS 3.563347\n8  MP20 5.511837\n\ngenetic_diversity(arapat, mode = \"He\")\n\n  Locus        He\n1  LTRS 0.4989034\n2   WNT 0.6528320\n3    EN 0.4489313\n4    EF 0.4361538\n5   ZMP 0.3394444\n6   AML 0.8293685\n7  ATPS 0.7193649\n8  MP20 0.8185723\n\ngenetic_diversity(arapat, mode = \"Ho\")\n\n  Locus         Ho\n1  LTRS 0.23691460\n2   WNT 0.27840909\n3    EN 0.20555556\n4    EF 0.14404432\n5   ZMP 0.15454545\n6   AML 0.37058824\n7  ATPS 0.08539945\n8  MP20 0.44692737",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#per-stratum-estimates",
    "href": "genetic-diversity.html#per-stratum-estimates",
    "title": "5  Genetic Diversity",
    "section": "5.3 Per-Stratum Estimates",
    "text": "5.3 Per-Stratum Estimates\nProvide a stratum argument to compute diversity within each population:\n\ngenetic_diversity(arapat, stratum = \"Species\", mode = \"He\")\n\n     Stratum Locus         He\n2       Cape  LTRS 0.14720000\n3       Cape   WNT 0.23374726\n4       Cape    EN 0.42000000\n5       Cape    EF 0.06444444\n6       Cape   ZMP 0.00000000\n7       Cape   AML 0.53312835\n8       Cape  ATPS 0.11546667\n9       Cape  MP20 0.36791111\n10  Mainland  LTRS 0.38850309\n11  Mainland   WNT 0.03277778\n12  Mainland    EN 0.50285714\n13  Mainland    EF 0.27119377\n14  Mainland   ZMP 0.09500000\n15  Mainland   AML 0.53854875\n16  Mainland  ATPS 0.25038580\n17  Mainland  MP20 0.80670340\n18 Peninsula  LTRS 0.42591805\n19 Peninsula   WNT 0.50613781\n20 Peninsula    EN 0.17229600\n21 Peninsula    EF 0.48979592\n22 Peninsula   ZMP 0.41492187\n23 Peninsula   AML 0.72842417\n24 Peninsula  ATPS 0.52255763\n25 Peninsula  MP20 0.69148800\n\n\n\ngenetic_diversity(arapat, stratum = \"Species\", mode = \"Ae\")\n\n     Stratum Locus       Ae\n2       Cape  LTRS 1.172608\n3       Cape   WNT 1.305052\n4       Cape    EN 1.724138\n5       Cape    EF 1.068884\n6       Cape   ZMP 1.000000\n7       Cape   AML 2.141916\n8       Cape  ATPS 1.130540\n9       Cape  MP20 1.582056\n10  Mainland  LTRS 1.635331\n11  Mainland   WNT 1.033889\n12  Mainland    EN 2.011494\n13  Mainland    EF 1.372107\n14  Mainland   ZMP 1.104972\n15  Mainland   AML 2.167076\n16  Mainland  ATPS 1.334020\n17  Mainland  MP20 5.173397\n18 Peninsula  LTRS 1.741912\n19 Peninsula   WNT 2.024856\n20 Peninsula    EN 1.208161\n21 Peninsula    EF 1.960000\n22 Peninsula   ZMP 1.709173\n23 Peninsula   AML 3.682213\n24 Peninsula  ATPS 2.094494\n25 Peninsula  MP20 3.241365",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#individual-estimator-functions",
    "href": "genetic-diversity.html#individual-estimator-functions",
    "title": "5  Genetic Diversity",
    "section": "5.4 Individual Estimator Functions",
    "text": "5.4 Individual Estimator Functions\nEach diversity metric has a standalone function that operates on a single locus vector.\n\n5.4.1 Allelic Richness\n\nA(arapat$LTRS)\n\nA \n2 \n\n\n\n\n5.4.2 Effective Number of Alleles\n\nAe(arapat$LTRS)\n\n      Ae \n1.995623 \n\n\n\n\n5.4.3 Expected Heterozygosity\n\nHe(arapat$LTRS)\n\n       He \n0.4989034 \n\n\n\n\n5.4.4 Observed Heterozygosity\n\nHo(arapat$LTRS)\n\n       Ho \n0.2369146 \n\n\n\n\n5.4.5 Inbreeding Coefficient\n\nFis(arapat$LTRS)\n\n      Fis \n0.5251293 \n\n\n\n\n5.4.6 Exclusion Probability\n\nPe(arapat$LTRS)\n\n[1] 0.4989034",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#corrected-heterozygosity-neis",
    "href": "genetic-diversity.html#corrected-heterozygosity-neis",
    "title": "5  Genetic Diversity",
    "section": "5.5 Corrected Heterozygosity (Nei’s)",
    "text": "5.5 Corrected Heterozygosity (Nei’s)\nThe Hes and Hos modes require a stratum because they apply a small-sample correction per subpopulation:\n\ngenetic_diversity(arapat, stratum = \"Species\", mode = \"Hes\")\n\n       Locus       Hes\n1       LTRS 0.3233431\n2        WNT 0.2606681\n3         EN 0.3687470\n4         EF 0.2781409\n5        ZMP 0.1731159\n6        AML 0.6108282\n7       ATPS 0.2999070\n8       MP20 0.6284672\n9 Multilocus 0.3679022",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#multilocus-diversity",
    "href": "genetic-diversity.html#multilocus-diversity",
    "title": "5  Genetic Diversity",
    "section": "5.6 Multilocus Diversity",
    "text": "5.6 Multilocus Diversity\nThe multilocus_diversity() function computes a summary across all loci:\n\nmultilocus_diversity(arapat)\n\n[1] 0.8374656",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#selecting-specific-loci",
    "href": "genetic-diversity.html#selecting-specific-loci",
    "title": "5  Genetic Diversity",
    "section": "5.7 Selecting Specific Loci",
    "text": "5.7 Selecting Specific Loci\nYou can restrict the analysis to a subset of loci:\n\ngenetic_diversity(arapat, loci = c(\"LTRS\", \"WNT\"), mode = \"He\")\n\n  Locus        He\n1  LTRS 0.4989034\n2   WNT 0.6528320",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-diversity.html#comparing-populations",
    "href": "genetic-diversity.html#comparing-populations",
    "title": "5  Genetic Diversity",
    "section": "5.8 Comparing Populations",
    "text": "5.8 Comparing Populations\nA common workflow is to estimate diversity per population, then compare:\n\nhe_by_pop &lt;- genetic_diversity(arapat, stratum = \"Species\", mode = \"He\")\nhe_by_pop\n\n     Stratum Locus         He\n2       Cape  LTRS 0.14720000\n3       Cape   WNT 0.23374726\n4       Cape    EN 0.42000000\n5       Cape    EF 0.06444444\n6       Cape   ZMP 0.00000000\n7       Cape   AML 0.53312835\n8       Cape  ATPS 0.11546667\n9       Cape  MP20 0.36791111\n10  Mainland  LTRS 0.38850309\n11  Mainland   WNT 0.03277778\n12  Mainland    EN 0.50285714\n13  Mainland    EF 0.27119377\n14  Mainland   ZMP 0.09500000\n15  Mainland   AML 0.53854875\n16  Mainland  ATPS 0.25038580\n17  Mainland  MP20 0.80670340\n18 Peninsula  LTRS 0.42591805\n19 Peninsula   WNT 0.50613781\n20 Peninsula    EN 0.17229600\n21 Peninsula    EF 0.48979592\n22 Peninsula   ZMP 0.41492187\n23 Peninsula   AML 0.72842417\n24 Peninsula  ATPS 0.52255763\n25 Peninsula  MP20 0.69148800\n\n\n\nlibrary(ggplot2)\nggplot(he_by_pop, aes(x = Stratum, y = He, fill = Stratum)) +\n  geom_boxplot() +\n  theme_minimal() +\n  labs(title = \"Expected Heterozygosity by Species\",\n       y = \"He\") +\n  theme(legend.position = \"none\")",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Genetic Diversity</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html",
    "href": "genetic-structure.html",
    "title": "6  Population Structure",
    "section": "",
    "text": "6.1 The genetic_structure() Wrapper\nThis chapter covers the estimation of genetic structure statistics — measures of how genetic variation is partitioned among populations.\nThe genetic_structure() function dispatches to specific structure estimators based on the mode parameter:",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#the-genetic_structure-wrapper",
    "href": "genetic-structure.html#the-genetic_structure-wrapper",
    "title": "6  Population Structure",
    "section": "",
    "text": "Mode\nStatistic\nDescription\n\n\n\n\n\"Gst\"\nNei’s Gst\nProportion of total diversity among populations\n\n\n\"Gst_prime\"\nHedrick’s G’st\nGst corrected for marker diversity\n\n\n\"Dest\"\nJost’s D\nTrue differentiation measure\n\n\n\"Fst\"\nWright’s Fst\nFixation index",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#basic-usage",
    "href": "genetic-structure.html#basic-usage",
    "title": "6  Population Structure",
    "section": "6.2 Basic Usage",
    "text": "6.2 Basic Usage\nEstimate Gst across species:\n\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Gst\")\n\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3         EN 0.1823664 0.3678145 0.4498525 0.1823664\n4         EF 0.3653913 0.2772276 0.4368481 0.3653913\n5        ZMP 0.4961044 0.1712607 0.3398734 0.4961044\n6        AML 0.2723689 0.6045761 0.8308826 0.2723689\n7       ATPS 0.5856500 0.2983785 0.7201122 0.5856500\n8       MP20 0.2358115 0.6267430 0.8201419 0.2358115\n9 Multilocus 0.3835972 2.9284713 4.7509048        NA\n\n\nThe output provides per-locus estimates plus a multilocus estimate (last row). The multilocus estimate follows the approach of Culley et al. (2001).",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#hedricks-correction",
    "href": "genetic-structure.html#hedricks-correction",
    "title": "6  Population Structure",
    "section": "6.3 Hedrick’s Correction",
    "text": "6.3 Hedrick’s Correction\nFor highly polymorphic markers, Gst is constrained to small values. Hedrick’s correction accounts for this:\n\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Gst_prime\")\n\n       Locus       Gst        Hs        Ht  P\n1       LTRS 0.6067798 0.3229669 0.4997122  0\n2        WNT 0.9198112 0.2595040 0.6534819  0\n3         EN 0.3415214 0.3678145 0.4498525  0\n4         EF 0.5756163 0.2772276 0.4368481  0\n5        ZMP 0.6498859 0.1712607 0.3398734  0\n6        AML 0.8970188 0.6045761 0.8308826  0\n7       ATPS 0.9592390 0.2983785 0.7201122  0\n8       MP20 0.8297450 0.6267430 0.8201419  0\n9 Multilocus 0.6503121 0.3110927 0.5406400 NA",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#josts-d",
    "href": "genetic-structure.html#josts-d",
    "title": "6  Population Structure",
    "section": "6.4 Jost’s D",
    "text": "6.4 Jost’s D\nAn alternative differentiation measure that is independent of within-population diversity:\n\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Dest\")\n\n       Locus       Dest        Hs        Ht          P\n1       LTRS 0.17403908 0.3229669 0.4997122 0.17403908\n2        WNT 0.35469734 0.2595040 0.6534819 0.35469734\n3         EN 0.08651255 0.3678145 0.4498525 0.08651255\n4         EF 0.14722985 0.2772276 0.4368481 0.14722985\n5        ZMP 0.13563788 0.1712607 0.3398734 0.13563788\n6        AML 0.38154249 0.6045761 0.8308826 0.38154249\n7       ATPS 0.40072291 0.2983785 0.7201122 0.40072291\n8       MP20 0.34542581 0.6267430 0.8201419 0.34542581\n9 Multilocus 0.18912423 0.3660589 0.5938631         NA",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#permutation-testing",
    "href": "genetic-structure.html#permutation-testing",
    "title": "6  Population Structure",
    "section": "6.5 Permutation Testing",
    "text": "6.5 Permutation Testing\nUse the nperm parameter to test the null hypothesis that the structure parameter equals zero:\n\ngenetic_structure(arapat, stratum = \"Species\",\n                  mode = \"Gst\", nperm = 99)\n\n       Locus       Gst        Hs        Ht  P\n1       LTRS 0.3536942 0.3229669 0.4997122  0\n2        WNT 0.6028903 0.2595040 0.6534819  0\n3         EN 0.1823664 0.3678145 0.4498525  0\n4         EF 0.3653913 0.2772276 0.4368481  0\n5        ZMP 0.4961044 0.1712607 0.3398734  0\n6        AML 0.2723689 0.6045761 0.8308826  0\n7       ATPS 0.5856500 0.2983785 0.7201122  0\n8       MP20 0.2358115 0.6267430 0.8201419  0\n9 Multilocus 0.3835972 2.9284713 4.7509048 NA\n\n\nThe resulting P column indicates the probability of observing a value as extreme as the estimate under random permutation of individuals among strata.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#pairwise-structure",
    "href": "genetic-structure.html#pairwise-structure",
    "title": "6  Population Structure",
    "section": "6.6 Pairwise Structure",
    "text": "6.6 Pairwise Structure\nSet pairwise = TRUE to compute structure between all pairs of strata:\n\npw &lt;- genetic_structure(arapat, stratum = \"Species\",\n                        mode = \"Gst\", pairwise = TRUE)\npw\n\n               Cape  Mainland Peninsula\nCape             NA 0.2955307 0.3609387\nMainland  0.2955307        NA 0.2024045\nPeninsula 0.3609387 0.2024045        NA\n\n\nThis returns a symmetric matrix of pairwise multilocus estimates.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#restricting-to-specific-loci",
    "href": "genetic-structure.html#restricting-to-specific-loci",
    "title": "6  Population Structure",
    "section": "6.7 Restricting to Specific Loci",
    "text": "6.7 Restricting to Specific Loci\nUse the locus parameter to restrict the analysis:\n\ngenetic_structure(arapat, stratum = \"Species\",\n                  mode = \"Gst\", locus = \"LTRS\")\n\n  Locus       Gst        Hs        Ht         P\n1  LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n\n\n\ngenetic_structure(arapat, stratum = \"Species\",\n                  mode = \"Gst\", locus = c(\"LTRS\", \"WNT\"))\n\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3 Multilocus 0.4949065 0.5824709 1.1531942        NA",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#multilocus-assignment",
    "href": "genetic-structure.html#multilocus-assignment",
    "title": "6  Population Structure",
    "section": "6.8 Multilocus Assignment",
    "text": "6.8 Multilocus Assignment\nThe multilocus_assignment() function estimates the probability that an individual originates from each population based on multilocus genotype frequencies:\n\n# Compute stratum-level frequencies\nfreqs &lt;- frequencies(arapat, stratum = \"Species\")\n\n# Assign the first individual\nmultilocus_assignment(arapat[1, ], freqs)\n\nWarning in multilocus_assignment(arapat[1, ], freqs): This individual has\nmissing genotypes, cannot compre assignment probability to individuals who do\nnot have missing data.\n\n\n    Stratum  Probability Posterior\n3 Peninsula 3.205128e-07         1\n\n\nThe Posterior column gives the relative probability of assignment to each stratum given the individual’s multilocus genotype.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-structure.html#individual-estimator-functions",
    "href": "genetic-structure.html#individual-estimator-functions",
    "title": "6  Population Structure",
    "section": "6.9 Individual Estimator Functions",
    "text": "6.9 Individual Estimator Functions\nEach structure metric has a standalone function:\n\nGst(arapat, stratum = \"Species\")\n\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3         EN 0.1823664 0.3678145 0.4498525 0.1823664\n4         EF 0.3653913 0.2772276 0.4368481 0.3653913\n5        ZMP 0.4961044 0.1712607 0.3398734 0.4961044\n6        AML 0.2723689 0.6045761 0.8308826 0.2723689\n7       ATPS 0.5856500 0.2983785 0.7201122 0.5856500\n8       MP20 0.2358115 0.6267430 0.8201419 0.2358115\n9 Multilocus 0.3835972 2.9284713 4.7509048        NA\n\n\n\nGst_prime(arapat, stratum = \"Species\")\n\n       Locus       Gst        Hs        Ht  P\n1       LTRS 0.6067798 0.3229669 0.4997122  0\n2        WNT 0.9198112 0.2595040 0.6534819  0\n3         EN 0.3415214 0.3678145 0.4498525  0\n4         EF 0.5756163 0.2772276 0.4368481  0\n5        ZMP 0.6498859 0.1712607 0.3398734  0\n6        AML 0.8970188 0.6045761 0.8308826  0\n7       ATPS 0.9592390 0.2983785 0.7201122  0\n8       MP20 0.8297450 0.6267430 0.8201419  0\n9 Multilocus 0.6503121 0.3110927 0.5406400 NA\n\n\n\nDest(arapat, stratum = \"Species\")\n\n       Locus       Dest        Hs        Ht          P\n1       LTRS 0.17500476 0.3229669 0.4997122 0.17500476\n2        WNT 0.35493302 0.2595040 0.6534819 0.35493302\n3         EN 0.08807037 0.3678145 0.4498525 0.08807037\n4         EF 0.14808390 0.2772276 0.4368481 0.14808390\n5        ZMP 0.13611660 0.1712607 0.3398734 0.13611660\n6        AML 0.38225685 0.6045761 0.8308826 0.38225685\n7       ATPS 0.40086216 0.2983785 0.7201122 0.40086216\n8       MP20 0.34665943 0.6267430 0.8201419 0.34665943\n9 Multilocus 0.19056225 0.3660589 0.5938631         NA",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Population Structure</span>"
    ]
  },
  {
    "objectID": "genetic-distance.html",
    "href": "genetic-distance.html",
    "title": "7  Genetic Distance & Relatedness",
    "section": "",
    "text": "7.1 Genetic Distance\nThis chapter covers inter-individual and inter-population distance estimation, pairwise relatedness, and spatial autocorrelation analysis.\nThe genetic_distance() function computes distance matrices from genetic data. Some modes operate among individuals, others among populations (strata).",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Genetic Distance & Relatedness</span>"
    ]
  },
  {
    "objectID": "genetic-distance.html#genetic-distance",
    "href": "genetic-distance.html#genetic-distance",
    "title": "7  Genetic Distance & Relatedness",
    "section": "",
    "text": "7.1.1 Available Distance Metrics\n\n\n\nMode\nLevel\nDescription\n\n\n\n\n\"AMOVA\"\nIndividual\nInter-individual AMOVA distance\n\n\n\"Bray\"\nIndividual\nProportion of shared alleles\n\n\n\"Euclidean\"\nPopulation\nEuclidean frequency distance\n\n\n\"cGD\"\nPopulation\nConditional genetic distance\n\n\n\"Nei\"\nPopulation\nNei’s genetic distance (1978)\n\n\n\"Dps\"\nPopulation\nShared allele distance (1 - Ps)\n\n\n\"Jaccard\"\nPopulation\nJaccard set dissimilarity\n\n\n\n\n\n7.1.2 Individual-Level Distances\nAMOVA distance computes inter-individual genetic distances:\n\n# Subset for a manageable example\nsub &lt;- arapat[1:20, ]\nD_amova &lt;- genetic_distance(sub, mode = \"AMOVA\")\ndim(D_amova)\n\n[1] 20 20\n\nD_amova[1:5, 1:5]\n\n     [,1] [,2] [,3] [,4] [,5]\n[1,]    0   NA   NA   NA   NA\n[2,]   NA    0    1    2    5\n[3,]   NA    1    0    3    2\n[4,]   NA    2    3    0    5\n[5,]   NA    5    2    5    0\n\n\n\n\n7.1.3 Population-Level Distances\nPopulation-level distances require a stratum column:\n\nD_nei &lt;- genetic_distance(arapat, stratum = \"Species\", mode = \"Nei\")\nD_nei\n\n               Cape  Mainland Peninsula\nCape      0.0000000 0.7311289 0.9244791\nMainland  0.7311289 0.0000000 0.6851578\nPeninsula 0.9244791 0.6851578 0.0000000\n\n\n\nD_cgd &lt;- genetic_distance(arapat, stratum = \"Species\", mode = \"cGD\")\n\nWarning in popgraph::popgraph(x = mv, groups =\nfactor(as.character(x[[stratum]]))): 1 variables are collinear and being\ndropped from the discriminant rotation.\n\nD_cgd\n\n              Cape  Mainland Peninsula\nCape      0.000000  9.913083  7.136108\nMainland  9.913083  0.000000 16.490315\nPeninsula 7.136108 16.490315  0.000000\n\n\n\nD_euc &lt;- genetic_distance(arapat, stratum = \"Species\",\n                           mode = \"Euclidean\")\n\nMultilous estimates of Euclidean distance are assumed to be additive.\n\nD_euc\n\n              Cape Mainland Peninsula\nCape      0.000000 2.418731  2.494205\nMainland  2.418731 0.000000  2.140258\nPeninsula 2.494205 2.140258  0.000000\n\n\n\n\n7.1.4 Standalone Distance Functions\nEach distance metric also has a standalone function:\n\nD &lt;- dist_nei(arapat, stratum = \"Species\")\nD\n\n               Cape  Mainland Peninsula\nCape      0.0000000 0.7311289 0.9244791\nMainland  0.7311289 0.0000000 0.6851578\nPeninsula 0.9244791 0.6851578 0.0000000",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Genetic Distance & Relatedness</span>"
    ]
  },
  {
    "objectID": "genetic-distance.html#genetic-relatedness",
    "href": "genetic-distance.html#genetic-relatedness",
    "title": "7  Genetic Distance & Relatedness",
    "section": "7.2 Genetic Relatedness",
    "text": "7.2 Genetic Relatedness\nThe genetic_relatedness() function computes pairwise relatedness among individuals.\n\n7.2.1 Available Relatedness Estimators\n\n\n\nMode\nDescription\n\n\n\n\n\"Nason\"\nNason’s kinship coefficient (Fij)\n\n\n\"LynchRitland\"\nLynch & Ritland estimator\n\n\n\"Ritland\"\nRitland estimator\n\n\n\n\n\n7.2.2 Basic Usage\n\nsub &lt;- arapat[1:10, ]\nR &lt;- genetic_relatedness(sub, mode = \"Nason\")\n\nSome of your loci are missing, Fij will treat these as loci with all alleles with likelihood equal to the population allele frequency.\nSome of your loci are missing, Fij will treat these as loci with all alleles with likelihood equal to the population allele frequency.\nSome of your loci are missing, Fij will treat these as loci with all alleles with likelihood equal to the population allele frequency.\n\ndim(R)\n\n[1] 10 10\n\nR[1:5, 1:5]\n\n     [,1] [,2] [,3] [,4] [,5]\n[1,]    1  NaN  NaN  NaN  NaN\n[2,]  NaN    1  NaN  NaN  NaN\n[3,]  NaN  NaN    1  NaN  NaN\n[4,]  NaN  NaN  NaN    1  NaN\n[5,]  NaN  NaN  NaN  NaN    1\n\n\n\n\n7.2.3 Standalone Relatedness Functions\nPer-locus relatedness can also be estimated directly:\n\nr_nason &lt;- rel_nason(arapat$LTRS[1:10])\nr_nason[1:5, 1:5]\n\n     [,1] [,2] [,3] [,4] [,5]\n[1,]   NA  NaN  NaN  NaN  NaN\n[2,]  NaN   NA  NaN  NaN  NaN\n[3,]  NaN  NaN   NA  NaN  NaN\n[4,]  NaN  NaN  NaN   NA  NaN\n[5,]  NaN  NaN  NaN  NaN   NA",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Genetic Distance & Relatedness</span>"
    ]
  },
  {
    "objectID": "genetic-distance.html#spatial-autocorrelation",
    "href": "genetic-distance.html#spatial-autocorrelation",
    "title": "7  Genetic Distance & Relatedness",
    "section": "7.3 Spatial Autocorrelation",
    "text": "7.3 Spatial Autocorrelation\nThe genetic_autocorrelation() function performs the spatial autocorrelation analysis of Smouse & Peakall (1999). It requires two square distance matrices — one physical, one genetic — and a vector of distance bin boundaries:\n\n# Physical distance matrix\nP &lt;- strata_distance(arapat,\n                     longitude = \"Longitude\",\n                     latitude = \"Latitude\")\n\n# Genetic distance matrix\nG &lt;- genetic_distance(arapat, mode = \"AMOVA\")\n\n# Define distance bins\nbins &lt;- seq(0, max(P), length.out = 6)\n\n# Run autocorrelation\nresult &lt;- genetic_autocorrelation(P, G, bins = bins, perms = 99)\nresult\n\nThe output includes the spatial autocorrelation coefficient (R) for each distance class, the number of pairwise comparisons (N), and a p-value from the permutation test (P).",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Genetic Distance & Relatedness</span>"
    ]
  },
  {
    "objectID": "genetic-distance.html#strata-distances",
    "href": "genetic-distance.html#strata-distances",
    "title": "7  Genetic Distance & Relatedness",
    "section": "7.4 Strata Distances",
    "text": "7.4 Strata Distances\nThe strata_coordinates() function extracts per-stratum centroid coordinates, and strata_distance() computes physical (geographic) distances between them:\n\ncoords &lt;- strata_coordinates(arapat, stratum = \"Species\",\n                              longitude = \"Longitude\",\n                              latitude = \"Latitude\")\ncoords\n\n    Stratum Longitude Latitude\n3 Peninsula -111.9226 26.18956\n1      Cape -110.5805 24.25405\n2  Mainland -109.6759 26.97435\n\n\n\nstrata_distance(coords)\n\n          Peninsula     Cape Mainland\nPeninsula    0.0000 254.0525 239.8471\nCape       254.0525   0.0000 315.7868\nMainland   239.8471 315.7868   0.0000",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Genetic Distance & Relatedness</span>"
    ]
  },
  {
    "objectID": "population-graphs.html",
    "href": "population-graphs.html",
    "title": "8  Population Graphs",
    "section": "",
    "text": "8.1 Constructing a Population Graph\nPopulation Graphs are a graph-theoretic approach to understanding among-population genetic connectivity (Dyer & Nason 2004). Rather than assuming a specific model of gene flow (e.g., island or stepping-stone), population graphs estimate the conditional genetic covariance structure among populations, retaining only statistically significant edges.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#constructing-a-population-graph",
    "href": "population-graphs.html#constructing-a-population-graph",
    "title": "8  Population Graphs",
    "section": "",
    "text": "8.1.1 From a Data Frame\nThe easiest way to create a population graph is with population_graph(), which handles the conversion from genotypes to multivariate data internally:\n\ngraph &lt;- population_graph(arapat, stratum = \"Species\")\n\nWarning in popgraph(data, groups, ...): 1 variables are collinear and being\ndropped from the discriminant rotation.\n\ngraph\n\nIGRAPH 45b720f UNW- 3 3 -- \n+ attr: name (v/c), size (v/n), weight (e/n)\n+ edges from 45b720f (vertex names):\n[1] Cape    --Mainland  Cape    --Peninsula Mainland--Peninsula\n\n\n\n\n8.1.2 From a Multivariate Matrix\nFor more control, convert genotypes to multivariate format first, then call popgraph() directly:\n\nmv &lt;- to_mv(arapat)\ngroups &lt;- factor(arapat$Species)\ngraph &lt;- popgraph(mv, groups)\n\nWarning in popgraph(mv, groups): 1 variables are collinear and being dropped\nfrom the discriminant rotation.\n\ngraph\n\nIGRAPH b02f179 UNW- 3 3 -- \n+ attr: name (v/c), size (v/n), weight (e/n)\n+ edges from b02f179 (vertex names):\n[1] Cape    --Mainland  Cape    --Peninsula Mainland--Peninsula\n\n\nThe alpha parameter controls edge retention significance (default 0.05):\n\ngraph_strict &lt;- popgraph(mv, groups, alpha = 0.01)\n\nWarning in popgraph(mv, groups, alpha = 0.01): 1 variables are collinear and\nbeing dropped from the discriminant rotation.\n\ngraph_strict\n\nIGRAPH 35c848d UNW- 3 3 -- \n+ attr: name (v/c), size (v/n), weight (e/n)\n+ edges from 35c848d (vertex names):\n[1] Cape    --Mainland  Cape    --Peninsula Mainland--Peninsula\n\n\n\n\n8.1.3 From an Adjacency Matrix\nUse as.popgraph() to convert a pre-computed adjacency matrix:\n\nA &lt;- matrix(c(0, 1, 0, 1,\n              1, 0, 1, 0,\n              0, 1, 0, 1,\n              1, 0, 1, 0), nrow = 4)\nrownames(A) &lt;- colnames(A) &lt;- LETTERS[1:4]\ng &lt;- as.popgraph(A)\ng\n\nIGRAPH ec84e43 UNW- 4 4 -- \n+ attr: name (v/c), weight (e/n)\n+ edges from ec84e43 (vertex names):\n[1] A--B A--D B--C C--D",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#bundled-population-graphs",
    "href": "population-graphs.html#bundled-population-graphs",
    "title": "8  Population Graphs",
    "section": "8.2 Bundled Population Graphs",
    "text": "8.2 Bundled Population Graphs\nThe package includes two pre-computed population graphs:\n\ndata(lopho)\nlopho\n\nThis graph was created by an old(er) igraph version.\nℹ Call `igraph::upgrade_graph()` on it to use with the current igraph version.\nFor now we convert it on the fly...\n\n\nIGRAPH 6af7beb UNW- 21 52 -- \n+ attr: name (v/c), size (v/n), color (v/c), Region (v/c), weight (e/n)\n+ edges from 6af7beb (vertex names):\n [1] BaC--LaV    BaC--Lig    BaC--PtC    BaC--PtP    BaC--SnE    BaC--SnI   \n [7] BaC--StR    Ctv--PtP    Ctv--SLG    Ctv--SnF    Ctv--SenBas LaV--Lig   \n[13] LaV--PtC    LaV--SnE    LaV--SnF    LaV--TsS    Lig--PtC    Lig--SnI   \n[19] Lig--StR    Lig--TsS    PtC--SnE    PtC--StR    PtC--TsS    PtC--SenBas\n[25] PtP--SnF    PtP--SnI    PtP--SenBas SLG--SnF    SLG--SnI    SnE--StR   \n[31] SnE--TsS    SnF--SnI    SnI--StR    StR--TsS    StR--SenBas CP --Seri  \n[37] CP --SG     CP --SN     CP --TS     LF --PL     LF --SG     LF --SI    \n[43] PL --SenBas PL --SG     PL --SI     PL --SN    \n+ ... omitted several edges\n\n\n\ndata(upiga)\nupiga\n\nThis graph was created by an old(er) igraph version.\nℹ Call `igraph::upgrade_graph()` on it to use with the current igraph version.\nFor now we convert it on the fly...\n\n\nIGRAPH 3157d53 UNW- 18 58 -- \n+ attr: name (v/c), size (v/n), color (v/c), weight (e/n)\n+ edges from 3157d53 (vertex names):\n [1] SI  --PL     SI  --LF     SI  --CP     SI  --Ctv    SI  --TrV   \n [6] SI  --SenBas SG  --CP     SG  --Seri   SG  --EH     SG  --LaV   \n[11] PL  --LF     PL  --SN     PL  --Seri   PL  --EH     PL  --SenBas\n[16] TS  --CP     TS  --SN     TS  --Seri   TS  --EH     TS  --Ctv   \n[21] TS  --LaV    TS  --SnF    LF  --CP     LF  --SN     LF  --Ctv   \n[26] LF  --SLG    LF  --SnF    LF  --SnE    CP  --SN     CP  --EH    \n[31] CP  --LaV    CP  --SenBas SN  --Seri   SN  --SenBas Seri--SLG   \n[36] EH  --SLG    EH  --SenBas Ctv --SLG    Ctv --TrV    Ctv --BaC   \n+ ... omitted several edges",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#decorating-a-graph",
    "href": "population-graphs.html#decorating-a-graph",
    "title": "8  Population Graphs",
    "section": "8.3 Decorating a Graph",
    "text": "8.3 Decorating a Graph\nThe decorate_graph() function merges external data into graph vertex attributes. This is essential for spatial visualization:\n\ndata(baja)\nhead(baja)\n\n  Region Population Latitude Longitude\n1   Baja        BaC    26.59   -111.79\n2   Baja        Ctv    29.73   -114.72\n3   Baja        LaV    24.04   -109.99\n4   Baja        Lig    25.73   -111.27\n5   Baja        PtC    24.19   -111.15\n6   Baja        PtP    29.03   -113.90\n\n\n\nlopho_dec &lt;- decorate_graph(lopho, baja, stratum = \"Population\")\nvertex_attr_names(lopho_dec)\n\n[1] \"name\"      \"size\"      \"color\"     \"Region\"    \"Latitude\"  \"Longitude\"\n\n\nNow the graph nodes carry coordinate and metadata attributes.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#graph-metrics",
    "href": "population-graphs.html#graph-metrics",
    "title": "8  Population Graphs",
    "section": "8.4 Graph Metrics",
    "text": "8.4 Graph Metrics\n\n8.4.1 Node Properties\n\n# Vertex names\nV(lopho)$name\n\n [1] \"BaC\"    \"Ctv\"    \"LaV\"    \"Lig\"    \"PtC\"    \"PtP\"    \"SLG\"    \"SnE\"   \n [9] \"SnF\"    \"SnI\"    \"StR\"    \"TsS\"    \"CP\"     \"LF\"     \"PL\"     \"SenBas\"\n[17] \"Seri\"   \"SG\"     \"SI\"     \"SN\"     \"TS\"    \n\n\n\n# Degree (number of edges)\ndegree(lopho)\n\n   BaC    Ctv    LaV    Lig    PtC    PtP    SLG    SnE    SnF    SnI    StR \n     7      4      6      6      7      5      3      5      5      6      7 \n   TsS     CP     LF     PL SenBas   Seri     SG     SI     SN     TS \n     5      4      3      5      5      3      5      5      5      3 \n\n\n\n# Betweenness centrality\nbetweenness(lopho)\n\n   BaC    Ctv    LaV    Lig    PtC    PtP    SLG    SnE    SnF    SnI    StR \n     9     31      4      0      0     25      3      0     16      8     30 \n   TsS     CP     LF     PL SenBas   Seri     SG     SI     SN     TS \n     0      2      0     92     98      1     32     15      0      0 \n\n\n\n\n8.4.2 Centroid Distance\nThe multivariate centroid distance between population centroids in discriminant space:\n\nmv &lt;- to_mv(arapat)\ngroups &lt;- factor(arapat$Species)\ncd &lt;- centroid_distance(mv, groups)\ncd\n\n               [,1]      [,2]      [,3]      [,4]       [,5]       [,6]\nCape      0.0800000 0.9200000 0.1333333 0.8533333 0.00000000 0.00000000\nMainland  0.2638889 0.7361111 0.8194444 0.0000000 0.01388889 0.00000000\nPeninsula 0.6924603 0.3075397 0.3432540 0.0000000 0.59920635 0.03769841\n                 [,7]      [,8]       [,9]      [,10]       [,11]       [,12]\nCape      0.000000000 0.3000000 0.70000000 0.00000000 0.000000000 0.000000000\nMainland  0.000000000 0.2222222 0.00000000 0.63888889 0.111111111 0.000000000\nPeninsula 0.003968254 0.9007937 0.04960317 0.02380952 0.009920635 0.007936508\n              [,13]      [,14]      [,15]     [,16]       [,17]       [,18]\nCape      0.9666667 0.03333333 0.00000000 0.9333333 0.000000000 0.000000000\nMainland  0.7916667 0.15277778 0.02777778 0.5277778 0.000000000 0.000000000\nPeninsula 0.5714286 0.42857143 0.27976190 0.6726190 0.001984127 0.001984127\n               [,19]     [,20]       [,21]      [,22]     [,23]      [,24]\nCape      0.08666667 0.5733333 0.286666667 0.00000000 0.0000000 0.00000000\nMainland  0.00000000 0.0000000 0.000000000 0.00000000 0.0000000 0.05555556\nPeninsula 0.00000000 0.0000000 0.009920635 0.09722222 0.3174603 0.33730159\n              [,25]      [,26]       [,27]     [,28]       [,29]      [,30]\nCape      0.0000000 0.00000000 0.000000000 0.0000000 0.000000000 0.01333333\nMainland  0.0000000 0.01388889 0.361111111 0.1527778 0.000000000 0.00000000\nPeninsula 0.1964286 0.01785714 0.001984127 0.0000000 0.001984127 0.00000000\n                [,31]      [,32]      [,33] [,34] [,35]      [,36]      [,37]\nCape      0.013333333 0.94000000 0.00000000 0.000  0.02 0.00000000 0.00000000\nMainland  0.861111111 0.01388889 0.05555556 0.000  0.00 0.00000000 0.00000000\nPeninsula 0.003968254 0.00000000 0.00000000 0.625  0.00 0.03968254 0.03571429\n               [,38]       [,39]      [,40]      [,41]      [,42]      [,43]\nCape      0.01333333 0.000000000 0.00000000 0.00000000 0.00000000 0.00000000\nMainland  0.06944444 0.000000000 0.01388889 0.08333333 0.08333333 0.00000000\nPeninsula 0.28968254 0.005952381 0.00000000 0.00000000 0.00000000 0.01190476\n               [,44]     [,45]     [,46]      [,47]      [,48]      [,49]\nCape      0.00000000 0.0000000 0.0000000 0.00000000 0.00000000 0.00000000\nMainland  0.01388889 0.0000000 0.0000000 0.00000000 0.02777778 0.04166667\nPeninsula 0.38293651 0.1150794 0.3730159 0.03571429 0.00000000 0.01785714\n               [,50]     [,51]     [,52]      [,53]       [,54]       [,55]\nCape      0.00000000 0.0000000 0.0000000 0.00000000 0.000000000 0.006666667\nMainland  0.09722222 0.2916667 0.2222222 0.04166667 0.000000000 0.000000000\nPeninsula 0.05357143 0.0000000 0.0000000 0.00000000 0.001984127 0.000000000\n          [,56]     [,57] [,58]\nCape       0.18 0.7733333  0.04\nMainland   0.00 0.0000000  0.00\nPeninsula  0.00 0.0000000  0.00\n\n\n\n\n8.4.3 Centroid Variance\nMultivariate variance around each population centroid:\n\ncv &lt;- centroid_variance(mv, groups)\ncv\n\n     Cape  Mainland Peninsula \n 1.519820  2.169841  2.886842 \n\n\n\n\n8.4.4 Shannon Entropy\nShannon entropy quantifies the uncertainty in a probability distribution:\n\n# Entropy of the degree distribution\ndeg &lt;- degree(lopho)\np &lt;- deg / sum(deg)\nshannon_entropy(p)\n\n[1] 4.344766\n\n\n\n\n8.4.5 Edge Contortion\nA measure of how edges deviate from geographic expectations (requires decorated graph with coordinates):\n\nedge_contortion(lopho_dec)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#congruence-testing",
    "href": "population-graphs.html#congruence-testing",
    "title": "8  Population Graphs",
    "section": "8.5 Congruence Testing",
    "text": "8.5 Congruence Testing\n\n8.5.1 Topology Congruence\nCompare the topology of two population graphs:\n\ndata(lopho)\ndata(upiga)\ncongruence_topology(lopho, upiga)\n\nThis graph was created by an old(er) igraph version.\nℹ Call `igraph::upgrade_graph()` on it to use with the current igraph version.\nFor now we convert it on the fly...\nThis graph was created by an old(er) igraph version.\nℹ Call `igraph::upgrade_graph()` on it to use with the current igraph version.\nFor now we convert it on the fly...\n\n\nWarning in congruence_topology(lopho, upiga): These two topologies have\nnon-overlapping node sets!  Careful on interpretation.\n\n\nIGRAPH 93b08a9 UN-- 16 19 -- \n+ attr: name (v/c)\n+ edges from 93b08a9 (vertex names):\n [1] BaC --LaV    BaC --SnE    BaC --StR    Ctv --SLG    Ctv --SnF   \n [6] LaV --SnE    SLG --SnF    StR --SenBas CP  --SG     CP  --SN    \n[11] CP  --TS     LF  --PL     LF  --SI     PL  --SenBas PL  --SI    \n[16] PL  --SN     Seri--SG     Seri--SN     SN  --TS    \n\n\n\n\n8.5.2 Statistical Testing\nUse test_congruence() to test whether two graphs are more similar in topology than expected by chance:\n\ntest_congruence(lopho, upiga, method = \"combinatorial\")\n\n\n\n8.5.3 Permutation\nThe permute_popgraph() function creates a null distribution of graph topologies by permuting the data:\n\nnull_graphs &lt;- permute_popgraph(mv, groups, nperm = 99)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#subgraph-operations",
    "href": "population-graphs.html#subgraph-operations",
    "title": "8  Population Graphs",
    "section": "8.6 Subgraph Operations",
    "text": "8.6 Subgraph Operations\nThe - operator computes the difference between two popgraphs (removes edges in common). You can also extract subgraphs using igraph functions:\n\nsmaller &lt;- delete_vertices(lopho, \"SenBas\")\nV(smaller)$name\n\n [1] \"BaC\"  \"Ctv\"  \"LaV\"  \"Lig\"  \"PtC\"  \"PtP\"  \"SLG\"  \"SnE\"  \"SnF\"  \"SnI\" \n[11] \"StR\"  \"TsS\"  \"CP\"   \"LF\"   \"PL\"   \"Seri\" \"SG\"   \"SI\"   \"SN\"   \"TS\"",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#export-formats",
    "href": "population-graphs.html#export-formats",
    "title": "8  Population Graphs",
    "section": "8.7 Export Formats",
    "text": "8.7 Export Formats\n\n8.7.1 To Adjacency Matrix\n\nM &lt;- to_matrix(lopho)\nM[1:5, 1:5]\n\n    BaC Ctv LaV Lig PtC\nBaC   0   0   1   1   1\nCtv   0   0   0   0   0\nLaV   1   0   0   1   1\nLig   1   0   1   0   1\nPtC   1   0   1   1   0\n\n\n\n\n8.7.2 To Data Frame\n\ndf &lt;- to_df(lopho)\nhead(df)\n\n  name      size   color Region\n1  BaC 12.158810 #FDAE61   Baja\n2  Ctv  3.880886 #FDAE61   Baja\n3  LaV  3.533757 #FDAE61   Baja\n4  Lig  4.731355 #FDAE61   Baja\n5  PtC  4.684652 #FDAE61   Baja\n6  PtP 10.925375 #FDAE61   Baja\n\n\n\n\n8.7.3 To JSON\n\njson &lt;- to_json(lopho)\ncat(json)\n\n\n\n8.7.4 To Spatial Formats\n\n# As sf object\nsf_obj &lt;- to_sf(lopho_dec)\n\n# As KML\nto_kml(lopho_dec, file = \"lopho.kml\")\n\n\n\n8.7.5 To pgraph Format\nThe .pgraph format is a simple text representation:\n\nwrite_popgraph(lopho_dec, file = \"lopho.pgraph\")\n\n\n\n8.7.6 Reading a Population Graph\n\npath &lt;- system.file(\"extdata\", \"lopho.pgraph\", package = \"gstudio\")\ng &lt;- read_popgraph(path)\ng\n\nIGRAPH 10edd5e UNW- 21 50 -- \n+ attr: name (v/c), size (v/n), color (v/c), weight (e/n)\n+ edges from 10edd5e (vertex names):\n [1] BaC --LaV    BaC --Lig    BaC --PtP    BaC --SnE    BaC --SnI   \n [6] BaC --StR    BaC --SenBas Ctv --PtP    Ctv --SLG    Ctv --SnF   \n[11] Ctv --SenBas LaV --Lig    LaV --SnE    LaV --SnF    LaV --TsS   \n[16] Lig --PtC    Lig --SnE    Lig --SnI    Lig --StR    PtC --SnE   \n[21] PtC --StR    PtC --TsS    PtP --SnF    PtP --SnI    PtP --SenBas\n[26] SLG --SnF    SLG --SnI    SnE --StR    SnE --TsS    SnF --SnI   \n[31] SnI --StR    StR --TsS    StR --SenBas CP  --LF     CP  --Seri  \n[36] CP  --SG     CP  --SN     CP  --TS     LF  --PL     LF  --SG    \n+ ... omitted several edges",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "population-graphs.html#randomization",
    "href": "population-graphs.html#randomization",
    "title": "8  Population Graphs",
    "section": "8.8 Randomization",
    "text": "8.8 Randomization\nGenerate a random graph with the same number of nodes and a specified number of edges:\n\nrg &lt;- randomize_graph(lopho)\nrg\n\nIGRAPH ac565aa UN-- 21 52 -- \n+ attr: name (v/c)\n+ edges from ac565aa (vertex names):\n [1] BaC   --SnF    BaC   --SnE    BaC   --SenBas BaC   --SLG    BaC   --PL    \n [6] BaC   --SI     BaC   --TsS    CP    --TS     CP    --SnI    TsS   --CP    \n[11] CP    --PtC    SnF   --Ctv    SenBas--Ctv    PtC   --Ctv    TS    --Ctv   \n[16] TS    --LaV    TsS   --LaV    LaV   --Lig    SenBas--LaV    LaV   --SN    \n[21] SnE   --LF     LF    --SG     SnI   --LF     Lig   --StR    TsS   --Lig   \n[26] Lig   --PtP    Lig   --SN     PL    --PtC    SnF   --PL     PL    --SI    \n[31] PL    --SN     PtC   --Lig    PtC   --SN     PtC   --SG     PtC   --PtP   \n[36] StR   --PtP    PtP   --Seri   SnI   --PtP    SenBas--Seri   SnE   --Seri  \n+ ... omitted several edges",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Population Graphs</span>"
    ]
  },
  {
    "objectID": "visualization.html",
    "href": "visualization.html",
    "title": "9  Visualization",
    "section": "",
    "text": "9.1 Allele Frequency Plots\nThe gstudio package provides several ggplot2 layers and mapping tools for visualizing genetic data. This chapter covers allele frequency plots, population maps, population graph visualization, and interactive leaflet maps.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualization</span>"
    ]
  },
  {
    "objectID": "visualization.html#allele-frequency-plots",
    "href": "visualization.html#allele-frequency-plots",
    "title": "9  Visualization",
    "section": "",
    "text": "9.1.1 geom_locus()\nThe geom_locus() function creates a bar chart of allele frequencies for a single locus. Map the locus to the x aesthetic:\n\nggplot() +\n  geom_locus(aes(x = LTRS), data = arapat) +\n  labs(title = \"Allele Frequencies at LTRS\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nPartition by population using the fill aesthetic:\n\nggplot() +\n  geom_locus(aes(x = LTRS, fill = Species), data = arapat) +\n  labs(title = \"LTRS Allele Frequencies by Species\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n9.1.2 geom_frequencies()\nThe geom_frequencies() function takes pre-computed frequency data (from frequencies()) and plots it. This gives you more control over faceting:\n\nfreqs &lt;- frequencies(arapat, loci = \"LTRS\", stratum = \"Species\")\nggplot() +\n  geom_frequencies(freqs) +\n  facet_wrap(~Stratum) +\n  labs(title = \"LTRS Frequencies by Species\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualization</span>"
    ]
  },
  {
    "objectID": "visualization.html#spatial-sampling-maps",
    "href": "visualization.html#spatial-sampling-maps",
    "title": "9  Visualization",
    "section": "9.2 Spatial Sampling Maps",
    "text": "9.2 Spatial Sampling Maps\n\n9.2.1 geom_strata()\nThe geom_strata() function plots sampling locations as points on a map. It expects Longitude and Latitude columns in the data:\n\nggplot() +\n  geom_strata(aes(x = Longitude, y = Latitude, fill = Species),\n              data = arapat) +\n  labs(title = \"Araptus attenuatus Sampling Locations\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n9.2.2 geom_strata_label()\nAdd text labels to strata locations:\n\nggplot() +\n  geom_strata(aes(x = Longitude, y = Latitude), data = arapat) +\n  geom_strata_label(aes(x = Longitude, y = Latitude,\n                         label = Species),\n                    data = arapat) +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualization</span>"
    ]
  },
  {
    "objectID": "visualization.html#population-graph-visualization",
    "href": "visualization.html#population-graph-visualization",
    "title": "9  Visualization",
    "section": "9.3 Population Graph Visualization",
    "text": "9.3 Population Graph Visualization\n\n9.3.1 geom_popgraph()\nThe geom_popgraph() function creates a complete population graph visualization (edges + nodes) in a single call:\n\na &lt;- matrix(c(0, 1, 0, 1,\n              1, 0, 1, 0,\n              0, 1, 0, 1,\n              1, 0, 1, 0), nrow = 4)\nrownames(a) &lt;- colnames(a) &lt;- LETTERS[1:4]\ngraph &lt;- as.popgraph(a)\nigraph::V(graph)$x &lt;- c(1, 2, 1, 2)\nigraph::V(graph)$y &lt;- c(1, 1, 2, 2)\nigraph::V(graph)$group &lt;- c(\"X\", \"X\", \"Y\", \"Y\")\n\nBasic graph:\n\nggplot() +\n  geom_popgraph(graph, aes(x = x, y = y)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nColor nodes by group:\n\nggplot() +\n  geom_popgraph(graph, aes(x = x, y = y, fill = group)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n9.3.1.1 Customizing Appearance\n\nggplot() +\n  geom_popgraph(graph, aes(x = x, y = y, fill = group),\n                node.size = 5,\n                edge.color = \"darkgrey\",\n                edge.width = 1) +\n  theme_void()\n\n\n\n\n\n\n\n\n\n\n9.3.1.2 Auto Layout\nIf x and y are not specified, a force-directed layout is computed automatically:\n\nggplot() +\n  geom_popgraph(graph) +\n  theme_void()\n\n\n\n\n\n\n\n\n\n\n\n9.3.2 geom_nodeset() and geom_edgeset()\nFor finer control, use the separate node and edge layers:\n\nggplot() +\n  geom_edgeset(graph, aes(x = x, y = y)) +\n  geom_nodeset(graph, aes(x = x, y = y, fill = group)) +\n  theme_void()\n\n\n\n9.3.3 Edge Labels\n\nggplot() +\n  geom_popgraph(graph, aes(x = x, y = y)) +\n  geom_edgelabels(graph, aes(x = x, y = y)) +\n  theme_void()",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualization</span>"
    ]
  },
  {
    "objectID": "visualization.html#spatial-population-graphs",
    "href": "visualization.html#spatial-population-graphs",
    "title": "9  Visualization",
    "section": "9.4 Spatial Population Graphs",
    "text": "9.4 Spatial Population Graphs\nA common workflow is to decorate a population graph with coordinates and then overlay it on a map:\n\ndata(lopho)\ndata(baja)\nlopho_dec &lt;- decorate_graph(lopho, baja, stratum = \"Population\")\n\nThis graph was created by an old(er) igraph version.\nℹ Call `igraph::upgrade_graph()` on it to use with the current igraph version.\nFor now we convert it on the fly...\n\n\n\nggplot() +\n  geom_popgraph(lopho_dec,\n                aes(x = Longitude, y = Latitude),\n                node.size = 4) +\n  labs(title = \"Lophocereus Population Graph\",\n       x = \"Longitude\", y = \"Latitude\") +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualization</span>"
    ]
  },
  {
    "objectID": "visualization.html#spider-plots",
    "href": "visualization.html#spider-plots",
    "title": "9  Visualization",
    "section": "9.5 Spider Plots",
    "text": "9.5 Spider Plots\nThe spiderplot_data() function creates line segment data connecting each individual to its population centroid, useful for visualizing spatial dispersion:\n\nspider &lt;- spiderplot_data(arapat,\n                          stratum = \"Species\",\n                          longitude = \"Longitude\",\n                          latitude = \"Latitude\")\nggplot() +\n  geom_segment(aes(x = Longitude, y = Latitude,\n                   xend = cLongitude, yend = cLatitude,\n                   color = Species),\n               data = spider, alpha = 0.3) +\n  geom_point(aes(x = Longitude, y = Latitude, color = Species),\n             data = arapat) +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualization</span>"
    ]
  },
  {
    "objectID": "visualization.html#interactive-leaflet-maps",
    "href": "visualization.html#interactive-leaflet-maps",
    "title": "9  Visualization",
    "section": "9.6 Interactive Leaflet Maps",
    "text": "9.6 Interactive Leaflet Maps\nThe addAlleleFrequencies() function creates interactive leaflet maps with pie charts showing allele frequencies at each sampling location. This requires the leaflet and leaflet.minicharts packages:\n\nlibrary(leaflet)\nlibrary(leaflet.minicharts)\n\naddAlleleFrequencies(arapat,\n                     stratum = \"Species\",\n                     locus = \"LTRS\",\n                     longitude = \"Longitude\",\n                     latitude = \"Latitude\")",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Visualization</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html",
    "href": "simulation-parentage.html",
    "title": "10  Simulation & Parentage",
    "section": "",
    "text": "10.1 Building Populations from Frequencies\nThis chapter covers the forward-time population simulation framework and parentage analysis tools in gstudio.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html#building-populations-from-frequencies",
    "href": "simulation-parentage.html#building-populations-from-frequencies",
    "title": "10  Simulation & Parentage",
    "section": "",
    "text": "10.1.1 Allele Frequency Specification\nThe simulation tools start with specifying allele frequencies per population and locus. The make_populations() function requires a data.frame with Population, Locus, Allele, and Frequency columns:\n\nf1 &lt;- data.frame(\n  Population = \"A\",\n  Locus = rep(c(\"Loc1\", \"Loc2\", \"Loc3\"), each = 2),\n  Allele = rep(c(\"01\", \"02\"), times = 3),\n  Frequency = c(0.2, 0.8, 0.3, 0.7, 0.4, 0.6)\n)\nf2 &lt;- data.frame(\n  Population = \"B\",\n  Locus = rep(c(\"Loc1\", \"Loc2\", \"Loc3\"), each = 2),\n  Allele = rep(c(\"01\", \"02\"), times = 3),\n  Frequency = c(0.7, 0.3, 0.5, 0.5, 0.6, 0.4)\n)\nf3 &lt;- data.frame(\n  Population = \"C\",\n  Locus = rep(c(\"Loc1\", \"Loc2\", \"Loc3\"), each = 2),\n  Allele = rep(c(\"01\", \"02\"), times = 3),\n  Frequency = c(0.4, 0.6, 0.3, 0.7, 0.2, 0.8)\n)\nfreqs &lt;- rbind(f1, f2, f3)\nfreqs$Population &lt;- factor(freqs$Population, ordered = TRUE)\n\n\n\n10.1.2 Creating Populations\n\npop &lt;- make_populations(freqs, N = 30)\nhead(pop)\n\n  Population ID  Loc1  Loc2  Loc3\n1          A  1 02:02 01:02 01:02\n2          A  2 01:02 01:02 02:02\n3          A  3 02:02 02:02 02:02\n4          A  4 02:02 02:02 01:02\n5          A  5 02:02 01:02 02:02\n6          A  6 02:02 02:02 01:02\n\ntable(pop$Population)\n\n\n A  B  C \n30 30 30 \n\n\nYou can specify an inbreeding level with F:\n\npop_inbred &lt;- make_populations(freqs, N = 30, F = 0.3)",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html#migration-models",
    "href": "simulation-parentage.html#migration-models",
    "title": "10  Simulation & Parentage",
    "section": "10.2 Migration Models",
    "text": "10.2 Migration Models\nThe migration_matrix() function creates a K x K migration matrix where rows sum to 1. Element [i,j] is the proportion of population i that originates from population j.\n\n10.2.1 Island Model\nEqual migration among all populations:\n\nmigration_matrix(3, model = \"island\", m = 0.05)\n\n      Pop1  Pop2  Pop3\nPop1 0.950 0.025 0.025\nPop2 0.025 0.950 0.025\nPop3 0.025 0.025 0.950\n\n\n\n\n10.2.2 1D Stepping Stone\nMigration only between adjacent populations:\n\nmigration_matrix(c(\"A\", \"B\", \"C\", \"D\"),\n                 model = \"stepping_stone_1d\", m = 0.1)\n\n     A    B    C    D\nA 0.90 0.10 0.00 0.00\nB 0.05 0.90 0.05 0.00\nC 0.00 0.05 0.90 0.05\nD 0.00 0.00 0.10 0.90\n\n\n\n\n10.2.3 2D Stepping Stone\nGrid-based adjacency:\n\nmigration_matrix(4, model = \"stepping_stone_2d\",\n                 m = 0.1, nr = 2, nc = 2)\n\n     Pop1 Pop2 Pop3 Pop4\nPop1 0.90 0.05 0.05 0.00\nPop2 0.05 0.90 0.00 0.05\nPop3 0.05 0.00 0.90 0.05\nPop4 0.00 0.05 0.05 0.90\n\n\n\n\n10.2.4 Distance-Based\nMigration rate decays with distance:\n\ncoords &lt;- matrix(c(0, 0, 1, 0, 0.5, 1), ncol = 2, byrow = TRUE)\nmigration_matrix(3, model = \"distance\", m = 0.1, coords = coords)\n\n          Pop1      Pop2      Pop3\nPop1 0.9000000 0.0527864 0.0472136\nPop2 0.0527864 0.9000000 0.0472136\nPop3 0.0500000 0.0500000 0.9000000",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html#migration-events",
    "href": "simulation-parentage.html#migration-events",
    "title": "10  Simulation & Parentage",
    "section": "10.3 Migration Events",
    "text": "10.3 Migration Events\nA migration_event pairs a migration matrix with a generation interval, allowing temporal regime changes:\n\nm1 &lt;- migration_matrix(3, model = \"island\", m = 0.05)\nm2 &lt;- migration_matrix(3, model = \"island\", m = 0.20)\n\n# Low migration for generations 1-50\nevt1 &lt;- migration_event(m1, start = 1, end = 50)\n\n# High migration from generation 51 onward\nevt2 &lt;- migration_event(m2, start = 51)",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html#mutation-models",
    "href": "simulation-parentage.html#mutation-models",
    "title": "10  Simulation & Parentage",
    "section": "10.4 Mutation Models",
    "text": "10.4 Mutation Models\nThe mutation_model() function defines how alleles mutate during simulation:\n\n# Infinite Alleles Model\nmm_iam &lt;- mutation_model(rate = 0.001, model = \"iam\")\n\n# K-Allele Model (10 possible states)\nmm_kam &lt;- mutation_model(rate = 0.001, model = \"kam\", k = 10)\n\n# Stepwise Mutation Model\nmm_smm &lt;- mutation_model(rate = 0.001, model = \"smm\")",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html#forward-time-simulation",
    "href": "simulation-parentage.html#forward-time-simulation",
    "title": "10  Simulation & Parentage",
    "section": "10.5 Forward-Time Simulation",
    "text": "10.5 Forward-Time Simulation\nThe simulate_pop() function runs a multi-generation forward-time simulation. Each generation cycle: census, migrate, mate, mutate.\n\n10.5.1 Basic Simulation\n\npop &lt;- make_populations(freqs, N = 30)\nresult &lt;- simulate_pop(pop, ngen = 20, verbose = FALSE)\nhead(result)\n\n  ID Population  Loc1  Loc2  Loc3\n1  1          A 01:02 01:01 01:02\n2  2          A 02:02 01:01 01:01\n3  3          A 02:02 01:02 02:02\n4  4          A 02:02 01:02 01:02\n5  5          A 02:02 01:02 02:02\n6  6          A 01:02 01:01 01:01\n\n\n\n\n10.5.2 With Migration\n\nm &lt;- migration_matrix(3, model = \"island\", m = 0.05)\nevt &lt;- migration_event(m, start = 1)\n\nresult &lt;- simulate_pop(pop, ngen = 20,\n                       migration = evt,\n                       verbose = FALSE)\n\n\n\n10.5.3 With Mutation\n\nmm &lt;- mutation_model(rate = 0.01, model = \"iam\")\nresult &lt;- simulate_pop(pop, ngen = 20,\n                       mutation = mm,\n                       verbose = FALSE)\n\n\n\n10.5.4 With Mixed Mating (Selfing)\n\nresult &lt;- simulate_pop(pop, ngen = 20,\n                       selfing_rate = 0.3,\n                       verbose = FALSE)\n\n\n\n10.5.5 Census Snapshots\nSave population snapshots at regular intervals:\n\nresult &lt;- simulate_pop(pop, ngen = 100,\n                       census_interval = 25,\n                       census_dir = tempdir(),\n                       verbose = FALSE)\n# Snapshots saved as gen_0025.rds, gen_0050.rds, etc.\n\n\n\n10.5.6 Complete Worked Example\nSimulate drift and migration in a 3-population system, then analyze the outcome:\n\n# Create starting populations\npop &lt;- make_populations(freqs, N = 50)\n\n# Set up island model migration\nm &lt;- migration_matrix(3, model = \"island\", m = 0.02)\nevt &lt;- migration_event(m, start = 1)\n\n# Run simulation\nset.seed(42)\nfinal &lt;- simulate_pop(pop, ngen = 50,\n                      migration = evt,\n                      verbose = FALSE)\n\n# Analyze structure in the final generation\ngenetic_structure(final, stratum = \"Population\", mode = \"Gst\")\n\n       Locus       Gst        Hs        Ht        P\n1       Loc1 0.2240740 0.3267340 0.4210891 0.224074\n2       Loc2 0.2950070 0.3156229 0.4476965 0.295007\n3       Loc3 0.1449410 0.4195286 0.4906429 0.144941\n4 Multilocus 0.2188736 1.0618855 1.3594285       NA\n\n\n\n# Compare diversity before and after\ngenetic_diversity(pop, stratum = \"Population\", mode = \"He\")\n\n   Stratum Locus     He\n2        A  Loc1 0.3200\n3        A  Loc2 0.4118\n4        A  Loc3 0.4800\n5        B  Loc1 0.4118\n6        B  Loc2 0.5000\n7        B  Loc3 0.4800\n8        C  Loc1 0.4800\n9        C  Loc2 0.4118\n10       C  Loc3 0.3200\n\ngenetic_diversity(final, stratum = \"Population\", mode = \"He\")\n\n   Stratum Locus     He\n2        A  Loc1 0.0000\n3        A  Loc2 0.4712\n4        A  Loc3 0.4422\n5        B  Loc1 0.4712\n6        B  Loc2 0.0000\n7        B  Loc3 0.4838\n8        C  Loc1 0.4992\n9        C  Loc2 0.4662\n10       C  Loc3 0.3200",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html#parentage-analysis",
    "href": "simulation-parentage.html#parentage-analysis",
    "title": "10  Simulation & Parentage",
    "section": "10.6 Parentage Analysis",
    "text": "10.6 Parentage Analysis\n\n10.6.1 Mating and Offspring\nThe mate() function creates offspring from two parents:\n\nf &lt;- data.frame(\n  Locus = rep(paste0(\"Loc\", 1:4), each = 3),\n  Allele = rep(LETTERS[1:3], times = 4),\n  Frequency = rep(c(1/3, 1/3, 1/3), times = 4)\n)\nadults &lt;- make_population(f, N = 20)\noffs &lt;- mate(adults[1, ], adults[2, ], N = 5)\noffs\n\n  ID Loc1 Loc2 Loc3 Loc4\n1  1  A:C  C:C  B:C  B:C\n2  1  A:A  A:C  B:C  B:C\n3  1  B:C  C:C  B:C  B:C\n4  1  A:C  A:C  B:B  B:C\n5  1  A:B  A:C  B:C  B:C\n\n\n\n\n10.6.2 Maternal Subtraction\nThe minus_mom() function removes the maternal contribution from offspring genotypes. It takes a single data.frame where mothers have OffID = 0 and offspring have OffID != 0:\n\n# Combine mother and offspring into one data.frame\nmom_row &lt;- adults[1, ]\nmom_row$OffID &lt;- 0\noffs$OffID &lt;- 1:nrow(offs)\nfamily &lt;- rbind(mom_row, offs)\npaternal &lt;- minus_mom(family)\npaternal\n\n  ID Loc1 Loc2 Loc3 Loc4 OffID\n2  1  A:C    C  B:C    C     1\n3  1    A  A:C  B:C    C     2\n4  1    B    C  B:C    C     3\n5  1  A:C  A:C    B    C     4\n6  1    B  A:C  B:C    C     5\n\n\n\n\n10.6.3 Fractional Paternity\nThe paternity() function estimates the probability of each potential father siring each offspring:\n\noffs$OffID &lt;- 1:nrow(offs)\noffs$MomID &lt;- adults$ID[1]\npat &lt;- paternity(offs, adults[1, ], adults)\nhead(pat)\n\n  MomID OffID DadID        Fij\n1     1     1     2 0.29629630\n2     1     1     7 0.14814815\n3     1     1    12 0.14814815\n4     1     1    15 0.14814815\n5     1     1    18 0.14814815\n6     1     1    16 0.07407407\n\n\nThe Fij column gives the fractional paternity probability. Use strict = TRUE to retain only unambiguous assignments:\n\npat_strict &lt;- paternity(offs, adults[1, ], adults, strict = TRUE)\npat_strict\n\n[1] MomID OffID DadID Fij  \n&lt;0 rows&gt; (or 0-length row.names)\n\n\n\n\n10.6.4 Single-Parent Exclusion\nThe parent_finder() function identifies compatible parents for each offspring using exclusion. It requires a data.frame with ID and OffID columns, where adults have OffID = 0:\n\n# Prepare a combined data.frame\nlocus_cols &lt;- column_class(adults, \"locus\")\nadults2 &lt;- adults[, c(\"ID\", locus_cols)]\nadults2$OffID &lt;- 0\noffs2 &lt;- offs[, c(\"ID\", locus_cols)]\noffs2$OffID &lt;- 1:nrow(offs2)\ncombined &lt;- rbind(adults2, offs2)\nresult &lt;- parent_finder(combined)\nhead(result)\n\n  ID OffID ParentID       T\n1  1     1        1 0.06250\n2  1     1        2 0.06250\n4  1     1        7 0.06250\n6  1     1       15 0.06250\n3  1     1        5 0.03125\n5  1     1       12 0.03125\n\n\n\n\n10.6.5 Identifying Bad Parents\nThe bad_parents() function flags parent-offspring pairs that are genetically incompatible:\n\nbad_parents(offs, adults)",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  },
  {
    "objectID": "simulation-parentage.html#bundled-parentage-datasets",
    "href": "simulation-parentage.html#bundled-parentage-datasets",
    "title": "10  Simulation & Parentage",
    "section": "10.7 Bundled Parentage Datasets",
    "text": "10.7 Bundled Parentage Datasets\nThe cornus and cornus_florida datasets contain Cornus florida genotype data for parentage analysis:\n\ndata(cornus)\nhead(cornus)\n\n  Population SampleID X.Coordinate Y.Coordinate   Cf.G8  Cf.H18   Cf.N5  Cf.N10\n1          2      203         3040         6146 157:165 117:119 170:170 189:191\n2          2      204         3070         6114 159:163 101:103 166:170 193:201\n3          2      205         3096         6148 151:157 113:119         193:195\n4          2      206         3124         6136 153:161 117:119         197:201\n5          2      207         3082         6126 159:163 105:119 158:170 193:193\n6          2      208         3148         5180 181:181 119:119 170:170 199:201\n    Cf.O5\n1 198:198\n2 178:182\n3 178:182\n4 178:198\n5 178:196\n6 176:182\n\n\n\ndata(cornus_florida)\nhead(cornus_florida)\n\n   ID OffID    X    Y      G8     H18      N5     N10      O5\n1 226     0 1392 3534 162:180 114:114 124:126 192:192 185:195\n2 232     0 1656 3414 158:180 112:112 124:126 184:192 185:185\n3 234     0 1718 3330 158:180  112:96 128:128 184:192 185:185\n4 300     0 1175 3114 180:188 112:116 126:126 198:200 191:195\n5 305     0 1529 3237 154:170 122:124 124:126 188:192 181:195\n6 432     0 1336 2748 164:180 114:116 124:126 198:202 185:193",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Simulation & Parentage</span>"
    ]
  }
]