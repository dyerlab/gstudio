{
  "hash": "430e9525b1f60dfc42e381b619edaf00",
  "result": {
    "engine": "knitr",
    "markdown": "# Population Structure\n\nThis chapter covers the estimation of genetic structure statistics --- measures of how genetic variation is partitioned among populations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gstudio)\ndata(arapat)\n```\n:::\n\n\n## The `genetic_structure()` Wrapper\n\nThe `genetic_structure()` function dispatches to specific structure estimators based on the `mode` parameter:\n\n| Mode | Statistic | Description |\n|------|-----------|-------------|\n| `\"Gst\"` | Nei's Gst | Proportion of total diversity among populations |\n| `\"Gst_prime\"` | Hedrick's G'st | Gst corrected for marker diversity |\n| `\"Dest\"` | Jost's D | True differentiation measure |\n| `\"Fst\"` | Wright's Fst | Fixation index |\n\n## Basic Usage\n\nEstimate Gst across species:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Gst\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3         EN 0.1823664 0.3678145 0.4498525 0.1823664\n4         EF 0.3653913 0.2772276 0.4368481 0.3653913\n5        ZMP 0.4961044 0.1712607 0.3398734 0.4961044\n6        AML 0.2723689 0.6045761 0.8308826 0.2723689\n7       ATPS 0.5856500 0.2983785 0.7201122 0.5856500\n8       MP20 0.2358115 0.6267430 0.8201419 0.2358115\n9 Multilocus 0.3835972 2.9284713 4.7509048        NA\n```\n\n\n:::\n:::\n\n\nThe output provides per-locus estimates plus a multilocus estimate (last row). The multilocus estimate follows the approach of Culley et al. (2001).\n\n## Hedrick's Correction\n\nFor highly polymorphic markers, `Gst` is constrained to small values. Hedrick's correction accounts for this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Gst_prime\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Gst        Hs        Ht  P\n1       LTRS 0.6067798 0.3229669 0.4997122  0\n2        WNT 0.9198112 0.2595040 0.6534819  0\n3         EN 0.3415214 0.3678145 0.4498525  0\n4         EF 0.5756163 0.2772276 0.4368481  0\n5        ZMP 0.6498859 0.1712607 0.3398734  0\n6        AML 0.8970188 0.6045761 0.8308826  0\n7       ATPS 0.9592390 0.2983785 0.7201122  0\n8       MP20 0.8297450 0.6267430 0.8201419  0\n9 Multilocus 0.6503121 0.3110927 0.5406400 NA\n```\n\n\n:::\n:::\n\n\n## Jost's D\n\nAn alternative differentiation measure that is independent of within-population diversity:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_structure(arapat, stratum = \"Species\", mode = \"Dest\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Dest        Hs        Ht          P\n1       LTRS 0.17403908 0.3229669 0.4997122 0.17403908\n2        WNT 0.35469734 0.2595040 0.6534819 0.35469734\n3         EN 0.08651255 0.3678145 0.4498525 0.08651255\n4         EF 0.14722985 0.2772276 0.4368481 0.14722985\n5        ZMP 0.13563788 0.1712607 0.3398734 0.13563788\n6        AML 0.38154249 0.6045761 0.8308826 0.38154249\n7       ATPS 0.40072291 0.2983785 0.7201122 0.40072291\n8       MP20 0.34542581 0.6267430 0.8201419 0.34542581\n9 Multilocus 0.18912423 0.3660589 0.5938631         NA\n```\n\n\n:::\n:::\n\n\n## Permutation Testing\n\nUse the `nperm` parameter to test the null hypothesis that the structure parameter equals zero:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_structure(arapat, stratum = \"Species\",\n                  mode = \"Gst\", nperm = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Gst        Hs        Ht  P\n1       LTRS 0.3536942 0.3229669 0.4997122  0\n2        WNT 0.6028903 0.2595040 0.6534819  0\n3         EN 0.1823664 0.3678145 0.4498525  0\n4         EF 0.3653913 0.2772276 0.4368481  0\n5        ZMP 0.4961044 0.1712607 0.3398734  0\n6        AML 0.2723689 0.6045761 0.8308826  0\n7       ATPS 0.5856500 0.2983785 0.7201122  0\n8       MP20 0.2358115 0.6267430 0.8201419  0\n9 Multilocus 0.3835972 2.9284713 4.7509048 NA\n```\n\n\n:::\n:::\n\n\nThe resulting P column indicates the probability of observing a value as extreme as the estimate under random permutation of individuals among strata.\n\n## Pairwise Structure\n\nSet `pairwise = TRUE` to compute structure between all pairs of strata:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npw <- genetic_structure(arapat, stratum = \"Species\",\n                        mode = \"Gst\", pairwise = TRUE)\npw\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Cape  Mainland Peninsula\nCape             NA 0.2955307 0.3609387\nMainland  0.2955307        NA 0.2024045\nPeninsula 0.3609387 0.2024045        NA\n```\n\n\n:::\n:::\n\n\nThis returns a symmetric matrix of pairwise multilocus estimates.\n\n## Restricting to Specific Loci\n\nUse the `locus` parameter to restrict the analysis:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_structure(arapat, stratum = \"Species\",\n                  mode = \"Gst\", locus = \"LTRS\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Locus       Gst        Hs        Ht         P\n1  LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenetic_structure(arapat, stratum = \"Species\",\n                  mode = \"Gst\", locus = c(\"LTRS\", \"WNT\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3 Multilocus 0.4949065 0.5824709 1.1531942        NA\n```\n\n\n:::\n:::\n\n\n## Multilocus Assignment\n\nThe `multilocus_assignment()` function estimates the probability that an individual originates from each population based on multilocus genotype frequencies:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute stratum-level frequencies\nfreqs <- frequencies(arapat, stratum = \"Species\")\n\n# Assign the first individual\nmultilocus_assignment(arapat[1, ], freqs)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in multilocus_assignment(arapat[1, ], freqs): This individual has\nmissing genotypes, cannot compre assignment probability to individuals who do\nnot have missing data.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Stratum  Probability Posterior\n3 Peninsula 3.205128e-07         1\n```\n\n\n:::\n:::\n\n\nThe `Posterior` column gives the relative probability of assignment to each stratum given the individual's multilocus genotype.\n\n## Individual Estimator Functions\n\nEach structure metric has a standalone function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGst(arapat, stratum = \"Species\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Gst        Hs        Ht         P\n1       LTRS 0.3536942 0.3229669 0.4997122 0.3536942\n2        WNT 0.6028903 0.2595040 0.6534819 0.6028903\n3         EN 0.1823664 0.3678145 0.4498525 0.1823664\n4         EF 0.3653913 0.2772276 0.4368481 0.3653913\n5        ZMP 0.4961044 0.1712607 0.3398734 0.4961044\n6        AML 0.2723689 0.6045761 0.8308826 0.2723689\n7       ATPS 0.5856500 0.2983785 0.7201122 0.5856500\n8       MP20 0.2358115 0.6267430 0.8201419 0.2358115\n9 Multilocus 0.3835972 2.9284713 4.7509048        NA\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGst_prime(arapat, stratum = \"Species\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Gst        Hs        Ht  P\n1       LTRS 0.6067798 0.3229669 0.4997122  0\n2        WNT 0.9198112 0.2595040 0.6534819  0\n3         EN 0.3415214 0.3678145 0.4498525  0\n4         EF 0.5756163 0.2772276 0.4368481  0\n5        ZMP 0.6498859 0.1712607 0.3398734  0\n6        AML 0.8970188 0.6045761 0.8308826  0\n7       ATPS 0.9592390 0.2983785 0.7201122  0\n8       MP20 0.8297450 0.6267430 0.8201419  0\n9 Multilocus 0.6503121 0.3110927 0.5406400 NA\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDest(arapat, stratum = \"Species\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Locus       Dest        Hs        Ht          P\n1       LTRS 0.17500476 0.3229669 0.4997122 0.17500476\n2        WNT 0.35493302 0.2595040 0.6534819 0.35493302\n3         EN 0.08807037 0.3678145 0.4498525 0.08807037\n4         EF 0.14808390 0.2772276 0.4368481 0.14808390\n5        ZMP 0.13611660 0.1712607 0.3398734 0.13611660\n6        AML 0.38225685 0.6045761 0.8308826 0.38225685\n7       ATPS 0.40086216 0.2983785 0.7201122 0.40086216\n8       MP20 0.34665943 0.6267430 0.8201419 0.34665943\n9 Multilocus 0.19056225 0.3660589 0.5938631         NA\n```\n\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}